% This is the aspauthor.tex LaTeX file
% Copyright 2010, Astronomical Society of the Pacific Conference Series

\documentclass[11pt,twoside]{article}
\usepackage{asp2010}

\resetcounters

\bibliographystyle{asp2010}

\markboth{Currie et al.}{Starlink in 2013}

\newcommand{\aspconf}{ASP Conf.\ Ser.}

\begin{document}

\title{Starlink Software in 2013}
\author{Malcolm~J.~Currie$^1$, David~S.~Berry$^1$, Tim~Jenness$^2$,
Andy~G.~Gibb$^3$, Graham~S.~Bell$^1$, and Peter~W.~Draper$^5$
\affil{$^1$Joint Astronomy Centre, 660 N.\ A`oh\=ok\=u Place, Hilo, HI
96720, USA}
\affil{$^2$Department of Astronomy, Cornell University, Ithaca, NY
  14853, USA}
\affil{$^3$Department of Physics and Astronomy, University of British
  Columbia, 6224 Agricultural Road, Vancouver, BC V6T~1Z1, Canada}
\affil{$^4$Department of Physics, University of Durham, South Road,
  Durham, DH1~3LE, UK}
}

\begin{abstract}
  Although the Starlink Project was closed in 2005, Starlink software
  continues to be developed and supported by the Joint Astronomy
  Centre for its data-reduction requirements. This paper summarises
  new features added since the \textit{Kapuahi} release in 2012, with
  emphasis on the reduction of sub-millimetre data, illustrated with
  SCUBA-2 continuum images and ACSIS/HARP spectral cubes of improved
  fidelity.
\end{abstract}

\section{Introduction}

The Starlink Software Collection is an open-source software project
hosted on github\footnote{\url{https://github.com/Starlink}} that has
been in constant development since 1980 \citep{1982QJRAS..23..485D}.

\section{Main Changes since the Kapuahi Release}

The \textit{Hikianalia} release was made in April 2013. The key
changes relative to the previous \textit{Kapuahi} release
\citep{P05_adassxxii} and subsequent changes are detailed below.

\subsection*{64-bit Integer Support}

Data sets have continued to grow in size and the need for 64-bit
integers has become more important. The \textit{Herschel} telescope
generates data products with 64-bit integers and people attempted to
convert these files into Starlink NDF format \citep[see][for an
overview of NDF]{P91_adassxxiii}, with little success. Historically we
had been reticent regarding the addition of support for 64-bit
integers given varied Fortran compiler support for the
\texttt{INTEGER*8} data type and requiring C99 compilers for a
guaranteed 64-bit data type in C (\texttt{int64\_t}). With modern
compilers this is no longer an issue and type \texttt{\_INT64} was
added to the Starlink file format (HDS) and the application code
dealing with multiple types was consistently modified to use code
automatically generated by the \textsc{Generic} application. This
required that many generic source files were re-generated from the
derived files which had been committed during the switch to a unified
revision control system back in 2005 \citep{2005ASPC..347..119G}.

\subsection*{Application Updates}

Applications such as \textsc{Convert}, \textsc{Ccdpack} and
\textsc{KAPPA} all automatically received the ability to process data
with 64-bit integers.

\altsubsubsection*{GAIA}

A new toolbox was added for overlaying STC-S regions on an image.

\altsubsubsection*{KAPPA}

Commands were added to report values of configuration parameters from
a text file (using the standard configuration format supported by the
\textsc{Grp} library) or NDF file history, and also to expand file lists.

Features were added to the commands \textsc{chanmap},
\textsc{collapse}, \textsc{mstats}, \textsc{normalize},
\textsc{parget}, \textsc{rotate}, \textsc{wcsadd}, and
\textsc{wcsremove}.

\altsubsubsection*{SMURF}

The main focus of the \textit{Hikianalia} release was to support the
reduction of data from SCUBA-2
\citep{2013MNRAS.430.2545C,2013MNRAS.430.2513H}. In particular a new
approach to map-making was developed whereby all data are involved in
each iteration rather than iteratively processing small chunks and
coadding them all at the end.  An example of this so-called
\textit{Skyloop} is presented in Figure~\ref{P82_F1}.

\articlefiguretwo{P82_WithoutSkyloopExample.jpeg}{P82_SkyloopExample.jpeg}{P82_F1}{The
left panel shows an example reduction of a SCUBA-2 continuum image
without the Skyloop technique.  The right panel shows the same data
after application of Skyloop.  Notice many diffuse false-emission blooms
now disappear.}


\altsubsubsection*{POLPACK}

A new command \textsc{polrotref} has been added to rotate the
reference direction of a pair of $Q$ and $U$ images.

\altsubsubsection*{SPLAT}

Much improved support for more complex SSAP queries \citep[see][for a
protocol introduction]{2004SPIE.5493..262D}.

\subsection*{Library Updates}

\altsubsubsection*{AST}

The AST library \citep[see][and references
therein]{2012ASPC..461..825B} can now read FITS headers that use the
SAO convention for representing a distorted TAN projection, and can
now handle missing \textsc{cnpix1} and \textsc{cnpix2} keywords in DSS
headers. There were also modifications to flux conservation and
normalisation in the rebinning routines.

\altsubsubsection*{NDF}

The NDF library will now limit the maximum size of an NDF
section. There have also been efficiency improvements in the way that
provenance information is stored.

\subsection*{ORAC-DR}

ORAC-DR \citep{Cavanagh2008} is the object-oriented perl pipeline used
and developed at the Joint Astronomy Centre, but also used at other
observatories such as Las Cumbres and AAO for optical, infrared, and
sub-millimetre data reduction.

\subsection*{Heterodyne}

Further improvements to the detection of bad spectra
\citep{P61_adassxxii} include automatic emission detection or
user-defined regions to excise emission from non-linear baseline
detections, a filter to identify spectra with ringing (the same
oscillation pattern appears in varying strength over tens of
contiguous time series).  Different options are now available to
determine the receptor-to-receptor flat field.  See
Figure~\ref{P82_F2} for an example.

\articlefiguretwo{P82_L1448_before.png}{P82_L1448_after.png}{P82_F2}{Reduced
HARP cubes integrated along the spectral axis over the source emission
in L1448.  The left panel shows the effect of ringing, which although
weaker extends over many more spectra than the common noise
interference, and relative receptor sensitivities.  The right
panel has the affected spectra excised and a flat field applied.}

The ACSIS/HARP pipeline can now process most data from the earlier DAS
backend, arising in part from better merging of hybrid data,
instrument-specific quality assurance criteria, and baseline
correction in line forests.

Although the goal is to provide high-quality results automatically for
JCMT Science Archive, many new tailoring recipe parameters, such as to
control memory requirements and the creation of a longitude-velocity
image, have been added.

\subsection*{SCUBA-2 \& PICARD}

A number of data-quality analysis recipes have been added that allow
an assessment the properties of SCUBA-2 data.
\begin{itemize}
\item Instrumental noise---this helps identify excessively noisy data that
can be excluded from map-maker (ASSESS\_DATA\_NOISE).
\item Calibration consistency---calculate flux-conversion factors and beam
sizes of standard sources to check calibration quality
(SCUBA2\_CHECK\_CAL).  This includes fitting of the source peak for FCF
calculations now attempts to fit two Gaussian components for high
(100) signal-to-noise ratio images of calibrators.
\item Output map noise (1/2)---calculate the noise and NEFD from map,
compare with those derived from noise calculations and the SCUBA-2
integration-time calculator (SCUBA2\_CHECK\_RMS).
\item Output map noise (2/2) - calculate the spatial power spectrum and
determine noise power on scales up to a high-pass filtering scale
(SCUBA2\_MAP\_PSPEC).
\end{itemize}


Further details of the changes can be found on the Starlink
web site\newline
(\texttt{http://starlink.jach.hawaii.edu/Releases}).

\acknowledgements This software has been supported by the UK Science
and Technology Facilities Council.  The Skyloop example was supplied
by Harriet Parsons.

\bibliography{P82}

\end{document}
