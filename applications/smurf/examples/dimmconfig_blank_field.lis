^$STARLINK_DIR/share/smurf/dimmconfig.lis

# *** Specialized config for deep scans of blank fields ***
#
# This config is aimed primarily at reducing blank fields -- extremely
# deep observations for detecting the individual point sources that
# produce the cosmic infrared background.
#
# Since there are no bright objects, a single high-pass filter is
# applied at the start, and no other iterative filtering is
# performed. A harsher high-pass filter is applied than in the default
# configuration since no appreciable large-scale structure is
# expected. Similarly, ast.zero_lowhits and ast.zero_notlast are used
# to help constrain the solution to a flat map until the final
# iteration.  Harsher bad-bolo rejection is implemented, and a lower
# threshold on spikes is also used. The number of iterations is
# hard-wired to 5, and seems to do a good job on the test data that
# has been looked at.
#
# When reducing a large data set it might be useful to write out the
# maps from each iteration/chunk by setting itermap=1.  This will
# produce a series of extensions (.MORE.SMURF.ITERMAPS) for each
# iteration, and for each continuous chunk of data. For example, they
# can be viewed using:
#
#   gaia [output map name].more.smurf.itermaps
#
# By flipping through the more.smurf.itermaps extension it is possible
# to get a good feel for how well the map is converging (and whether
# you would like more or less iterations). It is also useful to
# identify particularly noisy portions of the data. If the last
# iteration of a given chunk looks poor compared to the other chunks,
# you can identify the input files from the FITS header of the
# extension, and remove them.
#
# Setting shortmap=1 will give similar information, except now writing
# out a map each time a single time around the scan pattern has been
# completed.
#
# ***********************************************************

numiter = 5

modelorder = (com,gai,ext,ast,noi)

# be more aggressive about rejecting bad detectors

com.corr_tol = 3.5
com.gain_tol = 3.5
com.gain_abstol = 3

# Lower spike threshold.  Since the signal is small, and since this
# comes after all the other model components, the data should be
# fairly flat, so this is less dangerous.

ast.spikethresh = 5

# Heavier high-pass filtering. Note that the default padding/apodization
# that will be used is the number of samples that corresponds to the
# period of the knee frequency in the high-pass filter (i.e. 200*(1/freq) )

450.filt_edge_largescale = 150
450.flt.filt_edge_largescale = 150
450.cleandk.filt_edge_largescale = 150

850.filt_edge_largescale = 150
850.flt.filt_edge_largescale = 150
850.cleandk.filt_edge_largescale = 150

# can constrain much of the map to be zero until the final iteration
# since the structure is very low S/N and we are after point sources,
# not extended structure.

ast.zero_lowhits = 1.5
ast.zero_notlast = 1
