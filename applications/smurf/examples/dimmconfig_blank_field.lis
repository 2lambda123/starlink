^$STARLINK_DIR/share/smurf/dimmconfig.lis

# *** Specialized config for long scans of faint/compact sources ***
#
# The main feature of this config file is that we lower the thresholds
# for flagging bag detectors (com.*_tol), and we turn on iterative
# flagging of remaining (small) DC steps using noi.dc*. In order for
# this to work reasonably well it is important that the scan is long,
# and relatively faint astronomical source when compared to the total
# low-frequency drift of the detectors. If this dimmconfig were to be
# used for a short scan of a bright calibrator, the astronomical
# signal variations can be significant, and perfectly good detectors
# that see the source could be excluded from the map since they
# deviate significantly from the common-mode.
#
# We turn on the chunked common-mode rejection, using pieces about 5 min.
# in length. The reason for this is that the thresholds used for rejecting
# bolometers (comparing with common-mode) seem to depend on the length of
# the time series. Restricting the length will hopefully give more uniform
# results for different data sets.
#
# Since this dimmconfig file is more of an attempt at producing
# "science grade maps" the itermap=1 flag has been set. This will
# produce a series of extensions (.MORE.SMURF.ITERMAPS) in the main
# map for each iteration, and for each continuous chunk of data. For
# example, they can be viewed using:
#
#   gaia [output map name].more.smurf.itermaps
#
# By flipping through the more.smurf.itermaps extension it is possible
# to get a good feel for how well the map is converging (and whether
# you would like more or less iterations).
#
# ***********************************************************

# Create an extension containing the map after each iteration
itermap = 1

# ----------------------------------------------------------------------------
# The following parameters control data-cleaning before iterations start
# ----------------------------------------------------------------------------

# --- Padding, apodization and mean subtraction are all fairly useful ---

# Longer padding/apodization intervals to really try to avoid ringing

padstart = 1000
padend = 1000
apod = 1000

# Match dark squid apodization to main data array in case DKS is used
cleandk.apod = 1000

# ----------------------------------------------------------------------------
# These parameters control the iterative model components
# ----------------------------------------------------------------------------

# be more aggressive about rejecting bad detectors
com.corr_tol = 3.5
com.gain_tol = 3.5
com.gain_abstol = 3
#com.corr_abstol = 0.2

# low-pass filter dark squid signals using boxcar of this width (if dks
# model is specified)
dks.boxcar = 100

# Turn on some iterative dc step finding here, and a lower spike threshold.
# Since the signal is small, and since this comes after all the other
# model components, the data should be fairly flat, so this is less dangerous.

noi.dcfitbox = 400
noi.dcthresh = 3
noi.fillgaps = 1

noi.spikethresh = 5

# heavier high-pass filtering

450.flt.filt_edgehigh = 0.2
850.flt.filt_edgehigh = 0.6
flt.apod = 1000
