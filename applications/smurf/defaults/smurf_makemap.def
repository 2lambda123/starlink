#+
#  Name:
#     smurf_makemap.def

#  Purpose:
#     Default parameters for SMURF application MAKEMAP.

#  Description:
#     This file specifies the default parameters for the MAKEMAP
#     iterative map-maker.  The main purpose of this file is to
#     guarantee an initial state for all parameters and to define all
#     the allowed parameters so that a user will be notified in case
#     of spelling mistakes. In practice the default dimmconfig.lis (in
#     $STARLINK_DIR/share/smurf) contains the effective defaults since
#     all other config files source it and it contains the default
#     documentation.

#  Notes:
#     This file does not attempt to document what each value
#     means. See the dimmconfig.lis file for documentation.

#  Authors:
#     TIMJ: Tim Jenness (JAC, Hawaii)
#     DSB: David Berry (JAC, Hawaii)

#  History:
#     2010-05-05 (TIMJ):
#        Original version.
#     2010-05-12 (DSB):
#        Added com.gain_is_one
#     2010-06-08 (EC):
#        Added two.amap, two.bmap
#     2010-06-13 (DSB):
#        Added com.offset_is_zero

#-

# These come from smf_iteratemap

numiter = -5
tstep = 100
chitol = <undef>
maptol = <undef>

memiter = 1
deldimm = 1

bolomap = 0
itermap = 0
shortmap = 0
flagmap = <undef>
sampcube = 0

ensureflat = 1
noexportsetbad = 0
varmapmethod = 1
maxlen = 0
pad = <undef>

# these are here instead of in smurf_sc2clean.def since they are used
# during concatenation, and not during calls to the cleaning function
downsampscale = 0
downsampfreq = 0

modelorder = (com,gai,ext,flt,ast,noi)
exportndf = 0

# Load the cleaning defaults
^$SMURF_DIR/smurf_sc2clean.def

# can turn off initial cleaning by setting this to 0
doclean = 1

# export raw data immediately after cleaning?
exportclean = 0

# add fake astronomical signal to the time series?
fakemap = <undef>
fakescale = 1

# smf_model_create

# TSTEP is read in two locations.
# tstep = 100

# Also read in smf_calcmodel_com
# com.gain_box = 6000

# Load the tau relations from a separate config file
# Also load this before any other "ext" defaults in case
# they have local overrides for things other than
# tau relations.
^$SMURF_DIR/smurf_extinction.def

# We default these to be derived from the FITS headers
ext.csotau = <undef>
ext.filtertau = <undef>

# smf_get_extpar

ext.tausrc = auto
ext.taumethod = adaptive

# smf_calcmodel_ast

ast.gaussbg = 0
ast.zero_lowhits = 0
ast.zero_notlast = 1
ast.zero_circle = <undef>
ast.zero_snr = <undef>
ast.zero_mask = <undef>
ast.mapspike = 0

# smf_calcmodel_com -- these are defined in smurf_sc2clean.def

# smf_calcmodel_dks

dks.boxcar = 0
dks.replacebad = 0

# smf_calcmodel_gai -- see smf_calcmodel_com parameter defaults in
# smurf_sc2clean.def

# smf_calcmodel_flt

flt.notfirst = 0

# which calls smf_filter_fromkeymap which calls smf_get_cleanpar

flt.apod = 0
flt.zeropad = 0
flt.filt_edgelow = 0
flt.filt_edgehigh = 0
flt.filt_edge_smallscale = 0
flt.filt_edge_largescale = 0
flt.filt_notchlow = <undef>
flt.filt_notchhigh = <undef>
flt.whiten = 0

# Specifies the minimum fraction of good values that must contribute to a
# filtered value. For instance, if wlim is 0.9 then a filtered data value
# is flagged as bad unless at least 0.9 of the input values that
# contribute to it are good (i.e. have not been flagged as unusable for
# any reason). Thus a high filt_wlim value (i.e. close to 1.0) will cause
# more data to be rejected, and a low value (i.e. close to 0.0) will cause
# less data to be rejected. A value of <undef> causes the old filtering
# algorithm to be used that is based on filling gaps with artificial data.
# If the new algorithm is used the following additional settings can be
# made: "apod=0, fillgaps=0, noi.fillgaps=0".
flt.filt_wlim = <undef>

# smf_calcmodel_noi
noi.calcfirst = 0

# these are a subset of smf_get_cleanpar options

noi.dcfitbox = 0
noi.dcmaxsteps = 10
noi.dcthresh = 25.0
noi.dcsmooth = 50
noi.dclimcorr = 10
noi.fillgaps = 1
noi.zeropad = 0
noi.spikethresh = 0
noi.spikebox = 50

# Plane fitting

pln.notfirst = 0

# Time Series Smoothing

smo.notfirst = 0
smo.boxcar = 2000
smo.type = mean

# Two component common-mode

two.amap = <undef>
two.bmap = <undef>

# External template fitting

tmp.source = <undef>
tmp.dosin = 0
tmp.docos = 0
tmp.trigoffset = 0
