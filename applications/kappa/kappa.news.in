1 KAPPA_Version_2.5-9

   A new release of KAPPA is available in Starlink 2018A.  The main
   changes are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 Modified_applications

   o  ALIGN2D
      - The residuals used to determine the fit are now weighted using
      the SNR of the data rather than the reciprocal of the variance.
      This will cause the final alignment to be determined more by the
      brighter sections of the map than previously.

   o  COLLAPSE
      - There is a new estimator option, "FastMed", that offers a
      substantially faster calculation of unweighted medians.

   o  HISCOM

      - Has a new Parameter APPNAME, which can be used to change the
      application name stored in the new history record from the default
      of "HISCOM". Scripts that generate NDFs can use this facility to
      record the details of the invocation of the script in the form of a
      history record in the output NDF.

   o  SETAXIS
      - There is a new mode, "NDF".  It assigns the axis values using
      the data values in another NDF, specified by a parameter called
      AXISNDF.

   o  WCSALIGN
      -  The input NDFs can now be aligned with a specified POLPACK
      catalogue - see new parameter REFCAT.

   o  WCSMOSAIC
      -  Has a new parameter called WEIGHTS that can be used to specify
      a weight for each of the input NDFs.

1 KAPPA_Version_2.5

   A new release of KAPPA is available in Starlink 2017A.  The main
   changes are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 General_changes
   o  A log of KAPPA commands can now be written to a text file
   specified by the environment variable KAPPA\_LOG.  The log lists
   the application name and parameter values in separate headed lines.
   Note that the format of the log may change to simple command lines
   that could be replayed in a script.

2 Modified_applications

   o  ALIGN2D
      -  Parameter TR may also include the scale and offset in its seventh
      and eight elements.
      - The RMS residual between the aligned and the reference arrays is
      now written to an output parameter called "RMS".

   o  CONFIGECHO
      -  This now reports all elements in an array, not just the first
      element.

   o  CONTOUR
      -  The dynamic default for Parameter LABPOS is now "!" (i.e. a null
      value), so no label is now drawn in "Bounds" or "Good" mode unless a
      value is supplied explicitly for LABPOS.

   o  DISPLAY
      -  New Parameter PENRANGE can be used to restrict the range for pens
      (i.e. colour indices) used by the image.
      -  The vertical position of the key can now be controlled through
      Parameter KEYPOS.

   o  MFITTREND
      -  The auto method uses the median rather than the mean to clip
      outliers.  This permits better masking of strong and extended
      emission.

   o  SQORST
      -  Permit an axis scale to be retained by using an asterisk
      in Parameter PIXSCALE.

   o  TRANDAT
      -  Will now recognised the string "BAD" (case insensitive) within
      the input text file and generate appropriate bad values in the output
      NDF.

1 KAPPA_Version_2.4

   A new release of KAPPA is available in Starlink 2016A.  The main
   changes are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 New_applications

   o  ALIGN2D

      -  Aligns a pair of two-dimensional NDFs by minimising the
         residuals between them.

2 Modified_applications

   o  APERADD

      -  Has a new parameter MASK, which can be used to save an NDF
         containing a mask showing which pixels were included in the
         aperture.

   o  MFITTREND
      -  Has a new FOREST parameter, which improves spectral-line
         masking in line forests using a smoothed mode rather than
         the mean and a better estimate of the baseline noise.

   o  NORMALIZE

      - Has two new parameters DRAWMARK and DRAWWIDTH that can be used
        to exclude central markers and width indicator from the plot.

   o  PROVSHOW

      -  Has a new option SHOW=TREE, which allows the family tree to
         be stepped through in an interactive manner, with the user
         choosing which parent is to be displayed next.

   o  WCSADD

      -  Has a new option MAPTYPE=REFNDF, which causes a copy of a
         co-ordinate Frame read from a reference NDF to be added
         into the modified NDF.
      -  New parameter RETAIN allows control over whether or not the
         new Frame becomes the current Frame in the modified NDF on
         exit.


1 KAPPA_Version_2.3

   A new release of KAPPA is available in Starlink 2015B.  The main
   changes are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 New_applications

   o  NDFCOMPARE

      -  Compares two NDFs and reports whether they are equivalent, based
      on a range of different tests.

2 Modified_applications

   o  BEAMFIT

      -  Now works for HEALPix maps.
      -  More robust derivation of position errors.

   o  FITSMOD

      -  A missing END header may be appended using the Write mode.
      Any associated value and/or comment are ignored.  The easiest way
      to append an END header is with the wrapper FITSWRITE.

   o  NORMALIZE

      -  Now calculates and displays Pearson's coefficient of linear
      correlation on the remaining data at every iteration.
      -  New Parameter CORR added to hold the last displayed correlation
      coefficient.
      -  New Parameters OUTSLOPE, OUTOFFSET and OUTCORR added. These
      are one-dimensional NDFs in which the slopes, offsets and
      correlation coefficients respectively are stored when operating
      in looping mode (i.e. LOOP=TRUE).

   o  ROTATE

      -  Now writes out the rotation angle actually used to an output
      parameter (ANGLEUSED).

   o  SQOORT

      -  Propagates UNITS as it used to before the NDF version.


1 KAPPA_Version_2.2

   A new release of KAPPA is available in Starlink 2015A.  The main
   changes are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 Documentation_Changes

   - SUN/95 has been upgraded to the new style of documentation.
   Some residual collateral damage to the typesetting is likely to be
   present.
   -  Most of the old release notes have been removed from SUN/95,
   with just the few most-recent sets of notes retained in a separate
   appendix.
   -  The detailed descriptions of plotting and AST attributes are
   now in appendices.

2 Modified_applications

   o  COLLAPSE

      -  Fixed bug in the calculation of the variance for the Sum
      estimator.  Note that this applies to other collapsing commands
      such as MSTATS.

   o  CONFIGECHO

      -  A new parameter called LOGFILE has been added that allows the
      list of displayed configuration parameters to be written to a
      text file.

   o  COPYBAD

      -  Restore setting the BAD_PIXEL flag for the DATA and VARIANCE
      components, only setting it false if no bad pixels were copied
      and none existed in the input NDF.

   o SEGMENT

      -  A bug that caused a crash for NDFs with degenerate axes has
      been fixed.

   o  SETQUAL

      -  A new parameter QVALUE can be used to store a constant integer
      value in the range 0 to 255 in the QUALITY component for all pixels.

   o WCSALIGN

      - A new parameter ALIGNREF can be used to control the coordinate
      system in which the input NDFs are aligned.

   o WCSMOSAIC

      - A new parameter ALIGNREF can be used to control the coordinate
      system in which the input NDFs are aligned.


1 KAPPA_Version_2.1

   A new release of KAPPA (2.1) is available.  The main
   changes are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 New_applications

The following new applications have been added:

   o  EXCLUDEBAD will copy a two-dimensional NDF, excluding any rows
   or columns that contain too many bad values.  Good rows or columns
   are shuffled down to lower indices to fill the gaps left by the
   excluded rows or columns, thus causing the output NDF to be
   smaller than the input NDF.

2 Modified_applications

   o  ARDPLOT

      -  Can now display the outline of a Region even if no picture has
      been displayed previously on the graphics device.

   o  BEAMFIT

      -  There is now more control on the initial or fixed sizes and
      shapes of the beams.  See the documentation for Parameter
      FIXFWHM, and new Parameters FWHM, CIRCULAR for details.

      -  Note that this has involved a change of the type and
      function of Parameter FIXFWHM.  FIXFWHM like other FIX-
      parameters is _LOGICAL; it now just constrains whether the FWHM
      values should be fixed.  FWHM allows you to set actual sizes or
      initial guesses.

      -  The output parameters now store the statistics of every
      fitted beam, not just those of the primary beam.

   o  CENTROID

      -  The centroid's formatted co-ordinates, such as right
      ascension and declination, are now normalised into the usual
      ranges.  This aplies both to the reported positions and the
      output parameters.

   o  COPYBAD

      -  Now writes the number of good and bad pixels in the output NDF
      to output parameters NGOOD and NBAD.
      -  No longer sets the BAD_PIXEL flag for the DATA and VARIANCE
      components.

   o  CONFIGECHO

      -  A new parameter called LOGFILE has been added that allows the
      list of displayed configuration parameters to be written to a
      text file.

   o  DISPLAY

      -  The MODE parameter can now be set to "Current" to force the
      current upper and lower limits to be re-used.

   o  ERASE

      -  Now has a parameter called REPORT that indicates if an error
      should be reported if the specified object does not exist.

   o  GDCLEAR

      -  Will now remove any unused space from the graphics-database
      file, thus keeping its size to a minimum.

   o  HISTOGRAM

      -  The new parameter WIDTH offers the option to specify the bin
      width instead of the number of bins.

   o  MFITTREND

      -  Now has a parameter called PROPBAD, which controls whether to
      propagate bad input values to the returned fit.

   o  NDFECHO

      -  A new parameter called EXISTS has been added that allows the
      list of displayed NDF paths to be filtered by removing the paths
      for NDFs that do not exist.

   o  NORMALIZE

      -  This will loop if the first NDF is one-dimensional and the
      second is two-dimensional, provided LOOP=TRUE.  It previously
      only worked if the dimensionalities were in the reverse sense.

   o  OUTSET

      -  The USEAXIS parameter now works, needed when the supplied NDF
      has more than two axes.

   o  PROVADD

      -  The inoperative parameter MORE has been removed.

   o  SCATTER

      -  Now writes the number of pixels used to form the correlation
      coefficient to output parameter NPIX.

   o  SETQUAL

      -  It is now possible to copy all quality information from one
      NDF to another using a new parameter called LIKE.

   o  WCSALIGN

      -  The Gaussian kernel may now be applied in resampling mode as
      well as rebinning mode.

1 KAPPA_Version_2.0

   A new release of KAPPA (2.0) is available.  The main
   changes are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 General_changes
   o  Now supports 64-bit integer data.

2 New_applications

The following new applications have been added:

   o  CONFIGECHO is intended as a scripting tool. It displays the value
   of a named entry in a group of configuration parameters.

   o  NDFECHO is intended as a scripting tool. It expands a given
   group expression into a list of explicit NDF names, and displays
   a specified subset of the expanded names.

2 Modified_applications

   o  CHANMAP, COLLAPSE, and MSTATS

      -  Four new estimators are available: FBAD, FGOOD, NBAD and
      NGOOD, which produce the fraction/count of good/bad pixel
      values.

   o  NORMALIZE

      -  A new boolean parameter called LOOP permits normalisation
      against a single row or column when comparing two-dimensional
      NDFs.

   o  PARGET

      -  A new boolean parameter called VECTOR specifies the output
      format to use for vector-valued parameters.

   o  ROTATE

      - Now estimates north at the centre of the image rather than
      at the bottom left corner, and uses a more accurate method.

   o  WCSADD

      -  The transfer of set attribute values from basis Frame to new
      Frame can now be controlled using a new boolean parameter called
      TRANSFER (previously, set attributes were always transferred). The
      new default is to transfer attributes only if the two Frames have
      the same class and Domain.

   o  WCSREMOVE

      - The Frames to remove can now be specified by name as well as
      by index.

1 KAPPA_Version_1.13

   A new release of KAPPA (1.13) has been released.  The main
   changes are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 General_changes

   o  A new graphical style attribute called TEXTMARGIN controls
   the width of margins cleared around the edges of each drawn
   text string.

   o  Applications that report pixel scales (e.g. NDFTRACE,
   WCSFRAME) now report more representative pixel scales.  The pixel
   scales were previously measured at the first pixel in the array.
   Now the pixel scales are found at a number of places within the
   array, and the median of these values are reported.

   o  Colourmaps added from MRAO: Dave Green's cubehelix (in two
   forms), John Richer's colour spiral, and the SPECX bl2yl.

   o  Documentation improvements including on metacharacters,
   and units of regridding parameters, and updated AST Frame
   attributes.

2 Modified_applications

   o  ARDMASK

      -  The VARIANCE and DATA arrays in the NDF can now be masked
      simultaneously by setting the COMP parameter to "All", which is
      now the default value for COMP.

   o  FITSMOD

      -  New parameter READONLY allows FITSMOD to be used to perform
      read-only edits such as "Print" and "Exist" on write-protected
      NDFs, although FITSVAL and FITSEXIST tasks are recommended for
      these operations.

   o  FFCLEAN

      -  Now ignores a VARIANCE component full of bad values.

   o  HISTOGRAM

      -  Now permits plotting of the histogram for data-value limits
      that exceed the single-precision data range.
      -  The default for the AXES parameter has changed so that by
      default axes are only drawn if the picture is cleared.
      -  New parameter WEIGHTS allows different weights to be
      associated with each value in the input NDF.
      -  New Parameter WEIGHTSTEP defines the increment in weight
      value corresponding to a single integer histogram count.

   o  LINPLOT

      -  Monotonic AXIS values are now only required if the NDF
      current Frame is AXIS, or MODE="Step", or horizontal error
      bars are being drawn.

   o  LOOK

      -  New format "wglist" has been added, which lists the WCS
      co-ordinates and pixel values in an image, omitting bad pixels.
      -  New mode "All" has been added, which lists the entire
      supplied NDF.

   o  MFITTREND

      -  Permits processing of very large datasets by dividing into
      manageable sections.

   o  NDFTRACE

      -  Continues when it encounters an error within a WCS Frame.

   o  NORMALIZE

      -  The default for the AXES parameter has changed so that by
      default axes are only drawn if the picture is cleared.

      -  The new ZEROFF parameter can be set TRUE to force the fit to
      use an offset of zero.

   o  PASTE

      -  There is a new SHIFT parameter that applies constant shifts
      of origin between successive pasted data.

   o  PSF

      -  The default for the AXES parameter has changed so that by
      default axes are only drawn if the picture is cleared.

   o  REGRID

      -  The new parameter AXES allows regridding of selected
      pixel axes.
      -  It now uses AST_REBINSEQx rather than AST_REBINx.  This
      introduces a NORM parameter, which permits normalisation of
      the output array by the number of contributing input array
      elements.  Access to Parameter CONSERVE now depends on NORM,
      and CONSERVE's default has switched to preserve the total
      value.

   o  SCATTER

      -  The default for the AXES parameter has changed so that by
      default axes are only drawn if the picture is cleared.

      -  The Pearson correlation coefficient of the data in the
      scatter plot is now displayed, and written to the CORR output
      parameter.

   o  SETAXIS

      - For MODE="WCS" it tries to find the best WCS axis to use
      when the WCS axes are crossed or not parallel to the pixel axes.
      - "Linear_WCS" is a new MODE option.  It is a variant of "WCS"
      where the axis centres are set to the least-squares linear fit
      to the values of the selected axis.  This is useful for
      exporting co-ordinates to software with limited FITS WCS
      capabilities, such as no -TAB support, and when the
      non-linearity is small.

   o  SHOWQUAL

      -  Add new QNAMES output parameter to list the attribute name
      associated with each QUALITY bit.

   o  SQORST

      -  A new parameter called CONSERVE has been added, which may
      be set TRUE to force total flux to be conserved in the output
      NDF.

   o  TRANDAT

      -  When AUTO=FALSE, the new POFFSET parameter allows a shift
      to be specified between the data co-ordinates in the input text
      file, and the pixel co-ordinates in the output NDF.

   o  WCSALIGN

      -  If an input NDF has more pixel axes than the reference NDF,
      an attempt will now be made to align the input using the
      reference axes, whilst retaining the other axes.  Thus, if a
      three-dimensional spectral cube is aligned with a
      two-dimensional image, the resulting output NDF would be a
      three-dimensional cube, aligned spatially with the image.
      -  This now performs an extra normalisation step at the end to
      remove the effects of aliasing between the input and output
      pixel grids.
      -  This now performs an extra normalisation step at the end
      tp remove the effects of aliasing between the input and output
      pixel grids.
      -  The CONSERVE parameter is now used for both rebinning and
      resampling.  It defaults to the value of REBIN.

   o  WCSMOSAIC
      -  Added new CONSERVE and NORM parameters to control flux
      conservation and pixel normalisation.

1 KAPPA_Version_1.12

   A new release of KAPPA (V1.12-9) has been released.  The main
   changes are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 General_changes

   o  Parameters that set the plotting style can now recognise
   temporary attributes that only last for the duration of a
   single task, rather than persist until changed or reset.  The
   list of temporary attributes begin with a plus sign.  See
   "Temporary Attributes" in SUN/95 for examples.

   o  Style parameters are consistently documented as type GROUP.

2 Modified_applications

   o  BEAMFIT

      -  The model has been extended to a generalised Gaussian,
      for which the shape exponent may also be a free parameter of
      the fit.  This feature is controlled by the new GAUSS
      parameter, whose default retains the previous behaviour,
      namely fitting to a normal Gaussian (shape exponent=2).  There
      is a new GAMMA output parameter to record the shape exponent
      of the primary beam.

      -  Added error code KAP__LMFOJ for the most-common failure
      of the fitting.

   o  CLINPLOT

      -  Parameter MODE has a new option "GapHistogram", which
      behaves as "Histogram" except no flanking vertical lines are
      drawn either side of a bad value.

   o  CONVOLVE

      -  A new parameter NORM determines how the output NDF is
      normalised to take account of the total data sum in the PSF,
      and of the presence of bad pixels in the input NDF.
      -  It now permits PSFs with negative areas.

   o  HISTAT

      -  Bad percentile values are no longer written to the PERVAL
      output parameter.

   o  LINPLOT

      -  Parameter MODE has a new option "GapHistogram", which
      behaves as "Histogram" except no flanking vertical lines are
      drawn either side of a bad value.
      -  Parameter TEMPSTYLE is deprecated.

   o  LISTSHOW

      -  A new Parameter STEP has been added that allows a subset
      of the positions identifiers between FIRST and LAST to be
      displayed.

   o  MAKESURFACE

      -  Output variances can now be created for spline fits.

   o  NDFCOMPRESS

      -  Now supports "delta" compression---a lossless compression
      scheme suitable for integer arrays.

   o  NDFTRACE

      -  Writes Parameter FPIXSCALE even if QUIET=TRUE.

   o  PASTE

      -  The maximum number of NDFs that can be supplied via
      Parameter IN has increased from 26 to 1000.

   o  PSF

      -  A bug has fixed in the normalisation of the fit in cases
      where both the NORM and GAUSS parameters are set FALSE.

   o  STATS

      -  This now derives and reports the population skewness and
      kurtosis, which are also written to new SKEWNESS and KURTOSIS
      output parameters.  The standard deviation reported is now the
      population statistic, not the sample statistic as previously.
      For most practical uses the difference will be negligible.  To
      obtain the sample standard deviation, if appropriate, scale by
      (N/(N-1))**0.5, where N is the number of values used to derive
      the statistics (accessed through Parameter NUMGOOD).

      -  It now uses a recursive algorithm less susceptible to
      rounding errors for very large datasets or where data values
      are concentrated in a narrow range coupled with extreme
      outliers.

   o  WCSMOSAIC

      -  A bug in the use of the WLIM parameter has been fixed.
      If the VARIANCE parameter was set to YES, this bug resulted
      in WLIM being scaled by an arbitrary amount, causing the bad
      pixels in the output NDF to be wrong.  For instance, the
      entire output NDF could be filled with bad values as a
      result of this bug.  The bug did not occur if the VARIANCE
      parameter was set to NO.

   o  WCSSLIDE

      -  A bug has been fixed that could lead to incorrect shifts
      when using the ABS parameter.

1 KAPPA_Version_1.11

   A new release of KAPPA (V1.11-11) is available.  The main changes
   are listed below.  For complete details of all changes, see the
   "Release Notes" appendix in SUN/95.

2 Global_changes

   o Control of the verbosity of informational messages is now
   possible through the environment variable MSG_FILTER.  ILEVEL
   and QUIET parameters that previously controlled messaging are
   no longer used.  See Modified_applications for details.

   o  Added support and documentation for the new FRACTION Frame
   supplied with every NDF. Documented how NDF sections can now be
   defined by percentages along each dimension.

   o  The default for the CATFRAME parameter (used by various
   applications to indicate the Frame in which axis values should be
   stored within an output catalogue) has changed. It is now the
   current Frame in the WCS FrameSet associated with the input data.

   o  Additional colour tables from GAIA have been added.

   o  Application parameters that take "groups" of values are now
   stored in expanded form in the HISTORY component of any output
   NDFs.

2 New_applications

The following new applications have been added:

   o  CARPET is intended for the creation of `carpet plots' of images.
   It forms a three-dimensional NDF from a two-dimensional NDF where
   the original input axes are retained and the new third axis is
   proportional to the data values or signal-to-noise ratios of the
   input NDF.

2 Modified_applications

   o  APERADD, BEAMFIT, CENTROID, CREFRAME, CURSOR, LISTSHOW,
      LOOK, NDFTRACE, PICCUR, PICTRANS, WCSTRAN

      -  Parameter QUIET has been withdrawn.  Instead set the
      MSG_FILTER environment variable to QUIET to control the
      output messaging.

   o  BEAMFIT
      -  The map of residuals now contains the normal
      `data minus fit' evaluations rather than the reverse sense.
      -  The total background-subtracted data sum in the
      multi-Gaussian fit is now written to the output parameter SUM.
      -  After a bug fix it is now possible to fit beams within an
      arbitrary plane of a cube.
      -  Relax a constraint to cater better for a poor initial
      position.

   o  BLOCK

      -  The dimensionality restriction is now lifted.  This
      enables, for example, smoothing of a data cube in all its
      dimensions simultaneously.  As a consequence the AXES
      parameter is withdrawn.  However, you can replicate its
      function by setting one of the three BOX-parameter sizes to
      1 to specify the axis not being smoothed; the remaining two
      BOX values of 3 or more define a plane that is smoothed
      independently for all parallel planes.  The independent
      smoothing of axes is now generalised, so for example, you can
      smooth all lines in an image or cube; or all lines, planes,
      or cubes in a hypercube.
      -  It reports the input NDF's dimensionality if it is more
      than one, before prompting for Parameter BOX.

   o  CHANMAP, MSTATS

      -  Fix bug whereby Cmean and Csigma estimators were not
      amongst the allowed options.
      -  Allow ESTIMATOR=Median to operate on just three channels
      or NDFs.

   o  COPYBAD

      - The output NDF inherits data type of the input NDF, not that
      of the NDF given by Parameter REF.

   o  FFCLEAN

      -  Now works with double-precision data.

   o  FFCLEAN, MSTATS, WCSMOSAIC

      -  Parameter ILEVEL has been withdrawn.  Instead use the
      MSG_FILTER environment variable to control the output
      messaging.

   o  FITSLIST

      -  New Parameters ENCODING and FULLWCS allow the list of
      displayed FITS cards to include cards derived from the NDF WCS
      component, in addition to those read from the FITS extension.

   o  HISTAT

      -  Works for data ranges smaller than the type precision.
      -  The minimum sparseness increased from 4 to 16 percent to cope
      with extreme outliers, at the cost of poorer handling of
      quantized distributions.
      -  Generates a new histogram between any narrowed value limits
      to yield more-accurate statistics.

   o  HISTOGRAM

      -  This now displays an improved X-axis label on its plot.

   o  LINPLOT

      -  The Y-axis Symbol has changed from the NDF's label to the name
      of its plotted array component.  A long Symbol including spaces
      caused issues in other tasks like CURSOR, where the Symbol is used
      as a column name in the output catalogue.

   o  LOOK

      -  A bug has been fixed that caused logfile output to be
      truncated to 255 characters per row even if MAXLEN was greater
      than 255.

   o  NDFCOPY

      -  There is a new COMP parameter that permits the QUALITY,
      or VARIANCE components or the errors (square root of the
      VARIANCE) to become the DATA_ARRAY in the output NDF.

   o  PROVSHOW

      -  There is a new DOTFILE parameter that permits a summary of
      the provenance tree to be written to a text file in "dot"
      format, suitable for visualising with third-party tools such
      as Graphviz, ZGRViewer or OmniGraffle.

   o REGRID

     -  METHOD=GAUSS can now be used when re-sampling as well as
     when re-binning.

   o  SCATTER

      -  The calculation of the axis ranges now excludes any pixels
      that are bad in either NDF.

   o  SETAXIS

      -  If MODE is "WCS" and the selected axis is a celestial
      longitude or latitude axis, the axis units are now converted
      correctly from radians to degrees.

   o  WCSTRAN

      - There is a new SKYDEG parameter that can be used to force
      celestial longitude and latitude axis values to be formatted
      as decimal degrees, regardless of the setting of the Format
      attributes for the axes.

1 KAPPA_Version_1.10

   A new release of KAPPA (V1.10-10) is available.  The main
   changes so far are listed below.  For complete details of all
   changes, see the "Release Notes" appendix in SUN/95.

2 Modified_applications

   o  CHANMAP

      -  There are new estimators for clipped mean and clipped
      standard deviation and associated new CLIP parameter for
      controlling the clip level.

   o  CLINPLOT

      -  New MODE and MARKER parameters permit different ways to
      show the loci of data values including the histogram
      `staircase', dots or markers at each point, and lines
      connecting data points (the only available mode previously).

      -  New SPECAXES parameter can be used to suppress the drawing
      of axes around each spectrum.

      -  New ALIGN parameter controls whether to align the spectra
      spatially with an existing picture.

   o  COLCOMP

      -  Parameter BADCOL has the additional option of an HTML
      colour code.

   o  COLLAPSE

      -  There are new estimators for clipped mean and clipped
      standard deviation and associated new CLIP parameter for
      controlling the clip level.

      - There is an improved WLIM-related WARNING message.  The
      calculations used to decide whether or not to issue a
      warning and the reported fractions of bad values therein
      have been corrected.  These fractions had been in terms of
      elements along the collapse axis, not the number of elements
      in the output NDF.

   o  CONVOLVE

      -  No longer aborts if a slice within a cube contains no
      good data.

   o  DISPLAY

      -  Parameter BADCOL has the additional option of an HTML
      colour code.

   o  FITSMOD

      -  Parameter EDIT has a new option "Null".  This will
      nullify the value of the chosen keyword, by substituting
      spaces for its value.

      -  Likewise there is an Null option for Field 1 of the file
      format.

   o  HISCOM

      -  A new parameter called DATE has been added.  This allows
      the date and time of the new history record to be set explicitly
      rather than to the default current time.  There is a choice of
      formats including Gregorian Date and Time, and Julian Date.

   o  LISTMAKE

      -  The FRAME parameter now allows the co-ordinate frame to be
      specified in more ways (for example, as an AST Object dump or
      the current Frame in an NDF).

   o  LISTSHOW

      -  A new option ``STCS'' has been added to the PLOT parameter.
      This marks each position by drawing the shape giving in the
      column specified by new parameter STCSCOL. The shape is
      specified using the IVOA "STC-S" format.

   o  LOOK

      -  A new option "WLIST" has been added to the FORMAT parameter.
      This produces a list in which each row contains the WCS
      co-ordinates of a pixel follwoed by the pixel value.

   o  MSTATS

      -  There are new estimators for clipped mean and clipped
      standard deviation and associated new CLIP parameter for
      controlling the clip level.

   o  NDFCOPY

      -  A new parameter caller EXTEN has been added.  This can be set
      TRUE to cause any extension NDFs contained within the supplied
      NDF to be modified to match the shape of the output NDF.

      -  A new parameter called LIKEWCS has been added.  This
      allows the shape of the template NDF in the WCS Frame to be
      used to determine the bounds of the output NDF.

      -  A new logical parameter called TRIMBAD has been added.  If
      TRUE, the output NDF is trimmed to exclude any border of bad
      pixels.

   o PROVREM
      -  Has a new parameter called HIDE that can be set to TRUE
      to hide the selected ancestors rather than permanently deleting
      them. Hidden ancestors in an NDF PROVENANCE extension will in
      general be ignored by subsequent applications, but all the
      provenance information for hidden ancestors is retained
      unchanged in the PROVENANCE extension.

   o PROVSHOW
      -  Has a new parameter called HISTORY that can be set to TRUE
      to display any history records stored in the provenance
      extension of each ancestor NDF.
      -  Has a new parameter called HIDE that can be set to TRUE
      to include "hidden" ancestors in the display. Ancestors can be
      hidden using PROVREM.

   o  ROTATE

      -  Efficiency improvements have been made for rotations of 180
      degrees and arbitrary angles that should greatly reduce the
      memory requirements for processing cubes.  Additional
      efficiencies have be made for the 0-degree rotation special
      case.

   o STATS
      -  Can calculate accurate median and percentile values using
      sorting by setting the new ORDER parameter to TRUE,
      and optionally supplying percentiles through the new PERCENTILES
      parameter.  There are corresponding results parameters---MEDIAN
      and PERVAL---to record these additional statistics.

   o THRESH
      -  New result parameters NUMHI, NUMLO, NUMRANGE, and NUMSAME
      return the number of changed and unchanged pixels.

1 KAPPA_Version_1.9

   A new release of KAPPA (V1.9-11) is available.  The main changes
   are listed below.  For complete details of all changes, see the
   "Release Notes" appendix in SUN/95.

2 New_applications

   o  PROVMOD allows provenance to be modified within an NDF.  The
   CREATOR, DATE, and PATH components of the PROVENANCE extension
   may be altered using a substitution syntax incorporating string
   matching atoms and quantifiers.

   o  PROVREM allows selected provenance to be removed from an NDF.
   Ancestors can be removed by their indices or by pattern matching
   against their names.

   o  REGIONMASK masks an NDF using an AST Region description held
   in a text file.  Such descriptions can be generated, for instance,
   using the commands within the ATOOLS package.

   o  WCSSLIDE applies a translational correction to the World
   Co-ordinate System (WCS) of an NDF so that the WCS position of
   a given pixel is moved by a specified amount along each WCS axis.
   Thus it could be used to correct pointing errors.

2 Modified_applications

   o  COLLAPSE

      -  A COMP parameter is now available to collapse variance
      and quality information.

   o  FFCLEAN

      -  This has been extended to operate on cubes, either by
      processing the cubes as a set of independent one-dimensional
      spectra, or as a set of independent two-dimensional images
      (see the new parameter AXES).  Likewise you can process a
      two-dimensional NDF as a set of independent one-dimensional
      spectra.

      -  It can store the calculated noise level in the output
      variance array (see new parameter GENVAR).  If the NDF is
      processed as a set of spectra or images, then each
      individual spectrum or image is assigned its own noise
      level.

   o  FITSMOD

      -  Parameter EDIT has a new option "Amend".  This will write a
      new header if the chosen keyword does not exist, but will only
      modify an existing header.  Using this option, it is now not
      necessary to know whether or not a header exists.

      -  Likewise there is an Amend option for Field 1 of the file
      format.

   o  MAKESNR

      -  It is now faster when Parameter MINVAR is supplied on the
      command line.

   o  MFITTREND

      -  Cubic-spline fitting is now available, the type of fit is
      controlled by the new parameter FITTYPE.  There are two subtypes
      of fit selected by new parameter INTERPOL: interpolation through
      specified or equally spaced knots, or smoothing at automatically
      generated knots.  New parameter KNOTS sets the number or maximum
      number of knots respectively for the interpolation and smoothing
      splines. For the former, there is an additional parameter
      POSKNOT to specify knot locations.

   o  MSTATS

      -  This now offers a wider selection of statistics to combine
      the supplied NDFs.  Note that for consistency with other
      applications, the SMODE parameter has been replaced by
      ESTIMATOR. Scripts should be modified accordingly.

      -  There are two further new parameters: VARIANCE to control
      whether or not to use variance to weight the statistics
      (previously this effectively set true); and WLIM to decide
      the minimum fraction of good contributing value to form a
      non-bad output value.

      -  It uses NDF blocking to avoid excessive memory
      requirements.

   o  PROVSHOW has a new parameter SHOW that can be used to select the
   ancestors that are to be displayed (root ancestors, direct parents,
   or all ancestors).

   o  SETBB can now use a comma-separated list of quality names
   (such as created by SETQUAL) to define the bit mask instead of
   a numerical value.

   o  SETQUAL has new parameter, READONLY, that allows the new
   quality name to be flagged as "read only".  This flag indicates
   that an error should be reported if any subsequent attempt is
   made to remove the quality name (for instance, using REMQUAL).

   o  WCSMOSAIC Parameter GENVAR now allows a null value.  Null
   requests that a value of FALSE be adopted if and only if all the
   input NDFs have variance components.  TRUE is used otherwise.

2 General_changes

   o  Parameters that require one or more WCS axes to be
   specified---these are usually called USEAXIS, AXIS or AXES and
   appear in applications such LINPLOT, COLLAPSE and PLUCK---now
   accept generic names of those axes present (in addition to axis
   Symbol or indices).  These generic names are: "SPEC" to select
   the spectral axis, "TIME" to pick the time axis, and "SKYLON" and
   "SKYLAT" to choose the sky longitude and latitude axes
   respectively.


1 KAPPA_Version_1.8

   A new release of KAPPA (V1.8-9) is available.  The main changes are
   listed below.  For complete details of all changes, see the
   "Release Notes" appendix in SUN/95.

2 New_applications

   o  PLUCK extracts slices parallel to pixel axes from an NDF.  The
   slices are nominated positions that are not at pixel centres.  Thus
   it can be used for example, with a spectral imaging cube to extract
   spectra at specified equatorial co-ordinates, or an image at a
   given spectral co-ordinate.

   o  PROVADD modifies the provenance information stored in an NDF.  It
   records a second specified NDF as a direct parent of the first NDF.

   o  PROVSHOW displays details of the NDFs that were used in the
   creation of a supplied NDF.  This information is read from the
   PROVENANCE extension within the NDF, and includes both immediate
   parent NDFs and older ancestor NDFs.

2 Modified_applications

   o  ARDMASK

      -  This now has an option to use WCS co-ordinates in the input
      NDF as the default co-ordinate system for the supplied ARD
      description.  See the new parameter DEFPIX.

      -  It can now use a two-dimensional ARD description to mask each
      plane in a three-dimensional NDF.

   o  COLLAPSE issues a warning whenever any output values are set
      bad because there are too few contributing data values.  This
      reports the fraction of flagged output data in comparison with
      the WLIM parameter.  Input data containing only bad values are
      not counted in the flagged fraction, since no potential good
      output value has been lost.

   o  FILLBAD

      -  This is no longer limited to two-dimensional data.  The scale
      lengths (parameter SIZE) may be different along each pixel axis,
      and can be disabled along axes by supplying a scale length of
      zero for that axis.

   o  MAKESURFACE parameter VARIANCE set to TRUE now writes a uniform
      VARIANCE component to the output NDF.  Since the constant
      variance is the mean squared residual of the fit, variance
      information can be created for a spline fit.

   o  MFITTREND

      -  There are three new parameters: METHOD allows a choice of
      automatic de-trending methods.  The first of these handles each
      line independently, finding and masking features by binning and
      applying a threshold.  MASK stores the feature mask in an NDF.
      NUMBIN specifies the number of bins for the automatic mode.

      -  The reported fitting ranges are now given in the current
      co-ordinate system, along with the previously listed
      pixel ranges in parentheses.

   o  PSF has a new output parameter TOTAL which returns the total
      flux for the fitted Sersic function.

   o  SURFIT has a new parameter GENVAR to enable creation of a uniform
      VARIANCE component in the output NDF.  The constant variance is
      the mean squared residual of the fit.

   o  WCSATTRIB permits the setting of multiple attributes through new
      MSET option for parameter MODE, and the new parameter SETTING.

2 General_changes

   Each KAPPA command can now store provenance information in its
   output NDF(s) describing the input NDFs (this includes the
   provenance for each input NDF).

1 KAPPA_Version_1.7

   A new release of KAPPA (V1.7-10) has been made.  The main changes
   are listed below.  For complete details of all changes, see the
   "Release Notes" appendix in SUN/95.

2 New_applications

   o  BEAMFIT fits up to five Gaussians to beam features in a
   two-dimensional NDF, given initial co-ordinates defined in one
   of four modes.  Various fixed and relative constraints may be
   placed. It reports the coefficients and associated errors to
   the terminal, an optional logfile, and to results parameters.

2 Modified_applications

   o  ADD now propagates the UNITS component if it is the same in
   both input NDFs.

   o  ARDPLOT can now draw outlines around AST regions as well as
   ARD regions specified through a new REGION parameter.

   o  DIV now propagates any UNITS, combining them into a normalised
   form.

   o  COLLAPSE can now correctly collapse along a sky co-ordinate
   axis such as right-ascension or declination.

   o  COLLAPSE: The co-ordinate extent over which the collapse occurs
   may be retained in a dummy dimension provided a new parameter TRIM
   is set to FALSE.  The default of TRUE gives the current behaviour.

   o  FITSURFACE supports bi-cubic spline fitting and there is a new
   parameter KNOTS for that.  It creates a new provisional BSPLINE
   variant of the POLYNOMIAL structure in the NDF being fitted.

   o  FITSURFACE now writes PIXEL or AXIS values to the
   SURFACEFIT.COSYS component to bring it into line with AST usage.

   o  HISTAT has new parameters METHOD and NUMBIN that permit other
   ways to obtain the mode including the peak bin of an optimally
   binned histogram.

   o  HISTAT has additional and modified results parameters.  See
   the STATS changes below.

   o  LINPLOT has a new parameter ALIGNSYS that specifies the
   co-ordinate system in which a new plot and an existing plot are
   aligned when ALIGN is TRUE.

   o  MAKESURFACE reads the provisional BSPLINE variant of the
   POLYNOMIAL structure, and thus evaluates a spline fit of the
   input NDF.

   o  MAKESURFACE recognises GRID, PIXEL, and AXIS values for the
   SURFACEFIT.COSYS component.

   o  MFITTREND can now cope without an inverse WCS transformation.

   o  MULT now propagates any UNITS, combining them into a normalised
   form.

   o  NDFTRACE now reports a nominal pixel scale in output parameter
   FPIXSCALE.

   o  NDFTRACE has a new output parameter, FPIXSCALE, to store
   the nominal pixel scale or each axis in the current WCS Frame.

   o  A bug in ROTATE introduced at previous release is fixed.  It can
   again rotate a two-dimensional array with a dimension of one
   element, or a cube with two single-element dimensions.

   o  SQORST has a new MODE ="PixelScale" option, and new
   corresponding PIXSCALE and AXIS parameters.  These allow the WCS
   scales per pixel to be modified.  So for example, it can resample
   a spectral cube into a cube with a specified channel width.

   o  STATS There are two new output parameters---MAXWCS and
   MINWCS---that hold formatted WCS co-ordinates of the maximum- and
   minimum-valued pixels.  MAXCOORD and MINCOORD parameters now
   contain the corresponding numerical WCS co-ordinates, provided the
   NDF being analysed has a WCS FrameSet; otherwise they continue to
   hold the AXIS-component values.

   o  SUB now propagates the UNITS component if it is the same in
   both input NDFs.

   o  SURFIT This now uses singular value decomposition to solve the
   normal equations and hence provide the variances of the Chebyshev
   polynomial coefficients, stored in the SURFACEFIT extension.

   o  For the polynomial fit type, SURFIT creates a SURFACEFIT
   extension in the output NDF to hold the polynomial coefficients
   just as FITSURFACE does.

   o  WCSMOSAIC: VARIANCE components may be used to weight the
   input data if a new parameter VARIANCE is set to TRUE.
   Parameter VARIANCE defaults to the current behaviour.

   o  WCSMOSAIC has new output parameters FLBND and FUBND to record
   the WCS bounds of the output NDF.


1 KAPPA_Version_1.6

   A new release of KAPPA (V1.6-5) is available.  The main changes
   are listed below.  For complete details of all changes, see
   the "Release Notes" appendix in SUN/95.

2 New_applications

   o  CUMULVEC sums values cumulatively in a one-dimensional NDF.

   o  ODDEVEN removes odd-even defects from a one-dimensional NDF.
   To correct a two dimensional NDF of odd-even patterning in its
   columns or rows, first use COLLAPSE.

2 Modified_applications

   o  COLLAPSE now has a WCSATTS parameter to allow control of the
   frameset before collapsing occurs. This is important for estimators
   whose values depend on the WCS.  A new parameter VARIANCE controls
   whether or not variance information present in the input NDF is
   actually used.

   o  DISPLAY has a new parameter SQRPIX to control whether rectangular
   pixels are displayed as squares or rectangles.

   o  FITSLIST no longer wraps its output at 79 characters.

   o  LINPLOT  has a new parameter TEMPSTYLE.  Like STYLE it
   controls the plotting style, however, its assignments only apply
   to the current invocation.

   o  LISTSHOW has new parameter LABTYPE to control the sort of
   labels created---numerical or textual---when parameter LABEL
   is TRUE.

   o  In MFITTREND fits to lines may be rejected and flagged bad in
   the output data using the new parameter CLIPRMS.  Given the number
   of clipping standard deviations, MFITTREND locates positive
   outliers from the distribution of root-mean-squared residuals of
   the fits.  MFITTREND has a new output parameter, ARANGES, to
   record the fitting ranges found in automatic mode.  The automatic
   ranges are now constrained to the input NDF bounds.

   o  MLINPLOT now understands SpecFrames and FluxFrames.

   o  PSF now writes the first star position to the screen and
   output parameters as well as the log file.

   o  ROTATE can now reorient three-dimensional NDFs, in the sense
   that it will rotate all the two-dimensional planes within a
   three-dimensional NDF independently, applying the same rotation
   angle to each plane.  The rotation plane can be parallel to any
   face of the cube, and is defined by a new parameter AXES.

   o  WCSMOSAIC has nw eoutput parameters LBOUND and UBOUND record
   thec pixel bounds of the output NDF.  If parameter OUT is set to
   null, the mosaic's bounds can be examined without creating a
   potentially huge NDF.

1 KAPPA_Version_1.5

   A new release of KAPPA (V1.5) has been made.  The main changes are
   listed below.  For complete details of all changes, see the
   "Release Notes" appendix in SUN/95.

2 New_applications

   o  CHANMAP creates a two-dimensional channel map from a
   three-dimensional NDF by collapsing along a nominated pixel axis in
   each of a series of slices.  The collapsed slices are tiled with no
   margins to form the output channel map.  A wide selection of
   statistics is available for the collapsing.

   o  CLINPLOT draws a spatial grid of line plots for an axis of a
   cube NDF.  This is highly relevant to inspection of spectral-line
   data cubes.  In addition to the normal spectral axes around a line
   plot, there may be spatial axes drawn around the grid.

   o  INTERLEAVE forms a higher-resolution NDF by interleaving a set
   of NDFs of the same dimensionality.

   o  MAKESNR creates a signal-to-noise array from an NDF with
   defined VARIANCE component, rejecting unusably small variances.

   o  MFITTREND offers multiple fitting of trends to individual data
   lines of multi-dimensional NDFs has been added.  The trends are
   actually polynomials, which can be restricted to selected
   co-ordinate ranges, making this a useful tool for fitting the
   continua of independent spectra stored in data cubes.

   o  NDFCOMPRESS compresses an NDF so that it occupies less disk
   space.  The initial version has only one compression method,
   which scales using a linear transformation such that data values
   fit into a smaller data type.  Applications accessing the
   compressed NDF can reconstruct the original unscaled values.

   o  WCSMOSAIC forms a mosaic from a group of input NDFs using the
   associated WCS information to align them.

2 Modified_applications

   o  CURSOR can now display the pixel value at each selected position
   (if the position falls within the bounds of a displayed NDF).  This
   is controlled via the new parameters SHOWDATA and COMP.

   o  CHPIX has a new output parameter OLDVAL.  If the section being
   modified comprises one pixel, OLDVAL stores the original value of
   that pixel.

   o  COLLAPSE has eleven new statistics available to estimate
   the output values, intended for cube analysis.  The collapsed NDF
   is now physically smaller than the input NDF.

   o  CONTOUR parameter MODE has a new option to calculate contour
   heights called "Scale".  This sets a specified number of contour
   levels to be equally spaced between two pixel values that you supply.

   o  CONVOLVE and GAUSMOOTH can now smooth three-dimensional NDFs,
   in the sense that it will apply the PSF convolution or Gaussian
   filter respectively to all the two-dimensional planes within a
   three-dimensional NDF independently.  The smoothing plane can be
   parallel to any face of the cube and is defined by the new
   parameter AXES.

   o  COPYBAD now has an extra parameter called INVERT which, if set
   TRUE, causes output pixels to be set bad if the corresponding pixels
   in the reference NDF are good.

   o  FITSEXIST is now a self-contained application.  It needs only
   read access to an NDF, unlike the former version that was an alias
   to FITSMOD.  It should be faster too.

   o  A new parameter called CUMUL has been added to HISTOGRAM.  Setting
   CUMUL to TRUE will result in a cumulative histogram being produced.

   o  The MODE parameter in LISTMAKE now has an option "Good" which is
   like the existing "Pixel" option in that it creates a list
   containing pixel centres taken from the supplied NDF, but differs in
   that it only stored the centres of pixels which have a good value in
   the NDF Data array (the "Pixel" option stores all pixel centres,
   whether the pixel values are good or bad).

   o  LOOK parameter FORMAT has an extra option "cglist".  This is like
   "clist" except that bad values are not included in the list.

   o  NDFTRACE now displays details of the scaling used for Data or
   Variance arrays that are stored in ``SCALED'' format.

   o  SETVAR now provides the option to copy values from another NDF
   into the Variance component of the NDF being modified.

   o  The WCSALIGN and REGRID applications now have options for using a
   rebinning algorithm rather than a resampling algorithm.  Rebinning
   produces accurate flux conservation.  See the new REBIN parameter.

   o  The WCSALIGN and REGRID applications now have an option to produce
   approximate flux conservation when using the traditional resampling
   algorithm. See the new parameter CONSERVE.

   o  The WCSALIGN and REGRID applications now have options to use
   resampling or rebinning kernels based on a sombrero function
   2*J1(x)/x, where J1(x) is the first-order Bessel function of the
   first kind.

   o  WCSATTRIB permits read only access to the NDF for MODE=Get.

   o  The default values for the TOL parameter for REGRID, and the ACC
   parameter for WCSALIGN, have been reduced to 0.05, in order to
   reduce artefacts when transforming large images with flux
   conservation.

2 General_changes

   o  KAPPA is now released under the GNU Public Licence.

1 KAPPA_Version_1.4-2

   The main changes made at Version 1.4-2 were as follows.

   o  The BLOCK application can now smooth three-dimensional NDFs, in
   the sense that it will smooth all the two-dimensional planes within a
   three-dimensional NDF independently, using the same two-dimensional
   box.  The smoothing plane can be parallel to any face of the cube.

   o  The FITSVAL command is now a self-contained application.  It
   needs only read access to an NDF, unlike the former version
   that was an alias to FITSMOD.

   o  The NDFTRACE application now displays the bounds of the NDF within
   each WCS Frame if FULLFRAME is set to YES.  Also, the bounds of the
   NDF within the current WCS Frame are written to the new output
   parameters FLBND and FUBND.


1 KAPPA_Version_1.4-1

   The main changes made at Version 1.4-1 were as follows.

   o  The PIXDUPE application now has a facility for applying a mask to
   each block of output pixels.

   o  The WCSALIGN application now has a facility for aligning the input
   NDFs in-situ if possible (that is, if the alignment Mapping is a
   simple shift of origin).  The new parameters are INSITU and ABORT.

