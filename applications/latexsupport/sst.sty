\ProvidesPackage{sst}

%%%%
% Packet for formatting latex code output from prolat
%%%%%


%%% Create a new section class (at subsection level) for the sst routines
%\RequirePackage{titlesec}


%...  New subsection sstrefsection
\titleclass{\sstrefsection}{straight}[\subsection]
\newcounter{sstrefsection}
\renewcommand{\thesstrefsection}{\arabic{sstrefsection}}


%...  Formatting the title for sstrefsection
\titleformat{name=\sstrefsection}%
{\normalfont\Large\bfseries\centering}{}{0pt}{}
\titlespacing*{\sstrefsection}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}

%...  Command to turn name and short description into single variable for title.
\newcommand{\sstsectitle}[2]{\strut \vphantom{#1}#1\newline \ignorespaces#2\strut}

% ..  Command to completely remove section from contents so it can be added in manually at the correct section.
\newcommand{\nocontentsline}[3]{}
\newcommand{\tocless}[2]{\bgroup\let\addcontentsline=\nocontentsline#1{#2}\egroup}


\newcommand{\ssttitle}[2]{
  \tocless\sstrefsection{\centering\rule{\textwidth}{0.5mm}\\%
%\sstsectitle{#1}{#2}
#1\\#2\\\rule{\textwidth}{0.5mm}}
    \addcontentsline{toc}{subsection}{\protect\numberline{}\RemoveSpaces{#1}}}
%...  Basic command for producing the routine
\newcommand{\sstroutine}[3]{
  \clearpage
  % Create the section.
  \ssttitle{#1}{#2}

  % Set the first parameter as the label; need to remove spaces first.
  \label{\RemoveSpaces{#1}}

  %..  change the mark on the left hand side to include the name of the chapter.
  \markright{\textit{\RemoveSpaces{#1}}}
  \iftwoside
  \fancyhead[RE,LO]{\thepage\hspace{1cm}\rightmark}
  \else
  \lhead{\thepage\hspace{1cm}\rightmark}
  \fi

  %..  Nest all the material within a description
  \begin{description}[style=nextline]
    #3
  \end{description}

  % End the page
  \newpage
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% an environment for references (for the SST sstdiytopic command).
\newenvironment{refs}{\vspace{-4ex} % normally 3ex
                      \begin{list}{}{\setlength{\topsep}{0mm}
                                     \setlength{\partopsep}{0mm}
                                     \setlength{\itemsep}{0mm}
                                     \setlength{\parsep}{0mm}
                                     \setlength{\leftmargin}{1.5em}
                                     \setlength{\itemindent}{-\leftmargin}
                                     \setlength{\labelsep}{0mm}
                                     \setlength{\labelwidth}{0mm}}
                    }{\end{list}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%..  Define a \tt font of the required size.
\latex{\newfont{\ssttt}{cmtt10 scaled 1095}}

\newlength{\sstbannerlength}
\newlength{\sstcaptionlength}
\newlength{\sstexampleslength}
\newlength{\sstexampleswidth}

\newcommand{\sstdiytopic}[2]{\item[#1:]
\begin{description}[style=nextline]\item[]\end{description} #2}

\newcommand{\sstdescription}[1]{\item[Description:] #1 }
%\newcommand\vitem[1][]{\SaveVerb[%
%    aftersave={\item[\textnormal{\UseVerb[#1]{vsave}}]}]{vsave}}

\newcommand{\sstusage}[1]{\item[Usage:]{\raggedright \tt #1}}%\item[Usage:] \begin{Verbatim} #1 \end{Verbatim}}
\newcommand{\sstparameters}[1]{\item[Parameters:]
\begin{description}[style=nextline]\item[] #1 \end{description}}
\newcommand{\sstkeywords}[1]{\item[Keywords:]
\begin{description}[style=nextline]\item[] #1 \end{description}}

\newcommand{\sstsubsection}[2]{\item[{#1}] #2}
\newcommand{\sstnotes}[1]{\sstdiytopic{Notes}{#1}}
\newcommand{\sstdiylist}[2]{\item[#1] #2}
\newcommand{\sstimplementationstatus}[1]{\item[Implementation Status:]
  #1}
\newcommand{\sstbugs}[1]{\item[Bugs:] #1}

%  Format a list of items while in paragraph mode.
\newcommand{\sstitemlist}[1]{
  \mbox{}%\vspace{-1\baselineskip}
  \begin{itemize}
     #1
  \end{itemize}
}
\newcommand{\sstexamplesubsection}[2]{\sloppy
\item[{\texttt{\textcolor{MidnightBlue}{#1}}}] %\mbox{}\\% \vspace{1.0ex}
#2 }


% SSTEXAMPLES

% Set the font of the label of the sstexample items:
% (extra \\ spacing is required to not have weird effects. I think the
% important point is to explicitly force the label into vertical mode,
% so it doesn't try and continue the previous paragraph).
\newcommand{\sstexamplefont}[1]{\\#1\\\\}

\newcommand{\sstexamples}[1]{
  \setlength{\parindent}{0mm}
   \item[Examples:]
   \begin{description}[style=unboxed,font=\sstexamplefont,
     leftmargin=0pt,]
      #1
   \end{description}
}
%  Define the format of an item.
\newcommand{\sstitem}{\item\mbox{}}

%  Format the attribute data type section.
\providecommand{\sstattributetype}[1]{}%\item[Type:]#1}

%\newcommand{\sstattribute}[3]{\sstroutine{#1}{#2}{#3}}
\newcommand{\sstattribute}[3]{
  % Create the section.
  %\ssttitle{#1}{#2}
  \subsubsection[#1]{\centering \rule{\textwidth}{0.5mm}\\\Large\ignorespaces#1
    \\#2\\\rule{\textwidth}{0.5mm}}
  % Set the first parameter as the label; need to remove spaces first.
  \label{\RemoveSpaces{#1}}

  %..  change the mark on the left hand side to include the name of the section.
  \markright{\textit{\RemoveSpaces{#1}}}
  \iftwoside
  \fancyhead[RE,LO]{\thepage\hspace{1cm}\rightmark}
  \else
  \lhead{\thepage\hspace{1cm}\rightmark}
  \fi
  %..  Nest all the material within a description
  \begin{description}[style=nextline]
    #3
  \end{description}%
  %\rule{\textwidth}{0.5mm}\\
  % End the page
  %\clearpage
}

\renewcommand{\wedge}{\mbox{\textasciicircum}}

\newcommand{\ssthitemlist}[1]{\mbox{}\begin{itemize}#1\end{itemize}}
\newcommand{\sstapplicability}[1]{\sstdiytopic{Applicability}{#1}}
\newcommand{\sstresparameters}[1]{\sstdiytopic{Results Parameters}{#1}}
\newcommand{\sstarguments}[1]{\sstdiytopic{Arguments}{#1}}
\newcommand{\sstinvocation}[1]{\sstdiytopic{Invocation}{{\tt #1}}}
\newcommand{\sstreturnedvalue}[1]{\sstdiytopic{Returned Value}{#1}}
\newcommand{\sstimplementation}[1]{\sstdiytopic{Implementation}{#1}}

%\renewcommand{\backslash}{\textbackslash}


%% regular SST MACRO is exactly the same as SST routine.
%% (used in sun209)
\newcommand{\sstmacro}[3]{\sstroutine{#1}{#2}{#3}}

%% SST macronolabel should be same as regular sstroutine, but not
%% define a label (see sun209 -- this is because sun209 uses \textit
%% in some of its macro titles, so thesse cannot be automatically
%% changed to a label. The label must be manually created when
%% using these.
\newcommand{\sstmacronolabel}[3]{
  \clearpage
  % Create the section.
  \ssttitle{#1}{#2}

  % Set the first parameter as the label; need to remove spaces first.
  %\label{\RemoveSpaces{#1}}

  %..  change the mark on the left hand side to include the name of the chapter.
  \markright{\textit{\RemoveSpaces{#1}}}
  \iftwoside
  \fancyhead[RE,LO]{\thepage\hspace{1cm}\rightmark}
  \else
  \lhead{\thepage\hspace{1cm}\rightmark}
  \fi

  %..  Nest all the material within a description
  \begin{description}[style=nextline]
    #3
  \end{description}

  % End the page
  \newpage
}
