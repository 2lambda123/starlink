## Process this file with automake to produce Makefile.in


CGENERIC_ROUTINES = cupidgcfindmax.cgen cupidgciterate.cgen cupidrms.cgen \
cupidgcsetinit.cgen cupidgcupdatearrays.cgen cupidgcfit.cgen \
cupidgcprofwidth.cgen cupidgcdump.cgen

# The .c files which are built from the above .cgen files.
BUILT_C_ROUTINES = $(CGENERIC_ROUTINES:.cgen=.c)

BUILT_SOURCES = $(BUILT_C_ROUTINES)

# All the .c files which are put into the libcupidsub library. This
# includes the type-specific files which are created from the above
# generic .cgen files.
C_ROUTINES = cupidclumpfind.c cupidgaussclumps.c cupidconfigD.c \
cupidconfigI.c cupidgclistclump.c cupidgcmodel.c cupidgcchisq.c \
cupidgccalcf.c cupidgccalcg.c cupidgcdump.c cupidranval.c \
$(BUILT_C_ROUTINES)

noinst_LTLIBRARIES = libcupidsub.la

libcupidsub_la_SOURCES = $(C_ROUTINES)

AM_CFLAGS = -I..

$(C_ROUTINES:.c=.o): ../cupid.h

# Create the .c file which defines type-specific code generated from each 
# .cgen file.
$(CGENERIC_ROUTINES:.cgen=.c): 
	echo "/*" > $@
	echo "*  Name:" >> $@
	echo "*    $@" >> $@
	echo "" >> $@
	echo "*  Purpose:" >> $@
	echo "*    This file expands the generic C code held in $(@:.c=.cgen) to provide" >> $@
	echo "*    the required type-specific implementations which can be called by" >> $@
	echo "*    other functions." >> $@
	echo "" >> $@
	echo "*  Notes:" >> $@
	echo "*    - This file is generated automatically at build time (see" >> $@
	echo "*    cupidsub/Makefile.am)" >> $@
	echo "*/" >> $@
	echo "" >> $@
	echo "#include \"prm_par.h\"" >> $@
	echo "#include \"cgeneric.h\"" >> $@
	echo "" >> $@
	echo "#define CGEN_CODE_TYPE CGEN_DOUBLE_TYPE" >> $@
	echo "#include \"cgeneric_defs.h\"" >> $@
	echo "#include \"$(@:.c=.cgen)\"" >> $@
	echo "#undef CGEN_CODE_TYPE" >> $@
	echo "" >> $@
	echo "#define CGEN_CODE_TYPE CGEN_FLOAT_TYPE" >> $@
	echo "#include \"cgeneric_defs.h\"" >> $@
	echo "#include \"$(@:.c=.cgen)\"" >> $@
	echo "#undef CGEN_CODE_TYPE" >> $@
	echo "" >> $@





