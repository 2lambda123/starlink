<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Aperture Photometry Toolbox</title>
</head>

<body>
<a name="xref_aperture"></a>
<h2 align=center><font color=red>Aperture Photometry Toolbox</font></h2>
<h3>Making a simple measurement now</h3>
<p>In a hurry? Then try the following recipe:
<ol>
<li>Press the "Define object aperture" button.</li>
<li>Place your cursor on the image over the star.</li>
<li>Press down and hold down button 1.</li>
<li>Move the mouse sideways until the circle contains all the star.</li>
<li>Release the mouse button.</li>
<li>Press the "Calculate results" button.</li>
<li>Inspect the "Object details" and view the stars instrumental 
    magnitude, or mean count.</li>
</ol>
In this example the sky background is estimated using the region
between the outer and inner annuli. If this region contains any
contamination then you will need to create sky apertures.

<h3>Measuring several stars</h3>
<p>You can create as many apertures as you like by repeating the stages
described above. All apertures are re-measured each time the "Calculate
results" button is pressed.

<h3>Making measurements without an annulus</h3>
<p>Open the menu "Options" and select the "Use annular sky regions"
item. This now switches off the creation of the annulus region (note
this can also toggle the current aperture). Now create an object
aperture and then press the "Define sky aperture" button to create sky
apertures. These sky regions are just associated with this aperture
(note the colour change in sky aperture associated with an object
aperture).

<h3>Resizing or moving an aperture</h3>
<p>To move or resize an aperture you first need to "select"
it. Selecting is done by placing your mouse cursor over the aperture
and then pressing button 1. This should change the aperture colour and
one or two little boxes will appear on the locus. These little boxes
are known as grips.

<p>To move the aperture just drag the aperture by pressing down and
holding down button 1 over the aperture and then moving the mouse. The
aperture will follow.

<p>To resize the aperture drag a grip or use the sliders and entry
windows ("Semimajor axis:", "Eccentricity:", "Position angle:",
"Annulus inner scale:" and "Annulus outer scale:"). Note the sliders
and entry windows only work on the selected aperture. To activate a
value you type into a entry window press the &lt;Return&gt; key.

<h3>Making all apertures the same size</h3>
<p>To create apertures with a fixed size, or which are constrained to
be the same size, choose the "Options" menu and select the "Keep
apertures same size" option. Apertures will now be created with the
values shown in the "Semimajor axis:", "Eccentricity:", "Position
angle:", "Annulus inner scale:" and "Annulus outer scale:" windows.

<p>If you select one of these apertures and resize (or reorient) it,
in some way, then all the other apertures will track these changes.

<h3>Resizing more than one aperture at time</h3>
<p>To do this you must select all the apertures you want to modify
together. To do this select an aperture, then hold down the
&lt;Control&gt; button and select the next aperture etc. You can now
say change all the apertures to the same radius by typing a value into
the "Semimajor axis:" entry window and then pressing return. You can
also get the same effect by moving the slider.

<h3>Using elliptical apertures</h3>
<p>Open the "Options" menu and select the "Use circular apertures"
item. Any new apertures that you now create will be elliptical. Use
the grips to reorient and resize the aperture.

<h3>Viewing all measurements at once</h3>
<p>Just select the "Results" tab and press "View all
measurements". This creates a new window that lists all the current
apertures and their related values. Double click on a line to make
that aperture current.

<h3>Saving the measurements</h3>
<p>Just press the "Save" button. This will write all the current
measurements to a file "GaiaPhotomLog.Dat" by default. You can write
to a different file using the "Results" entry field.

<p>The "Append" button appends the current measurements to the end of the 
results file (preceded by the name of the current image in a
comment). Note the "Save" option overwrites the results file without
prompting.

<h3>Making the same measurements on other images</h3>
<p>To do this display your new image (either in a clone or by
superseding the existing image) and then open the "File" menu and
select the "Read measurements..." item. This allows you to select a
file with your existing measurements in. These apertures will now be
redrawn. Press "Calculate results" and then save the new measurements
to a new file.

<p>You can also use the results files together with the AUTOPHOTOM
program (see SUN/45) to redo the same measurements non-interactively.

<h3>Reading in a list of positions for measurement</h3>
<p>If you have a number of sources that you would like to measure using the
same apertures, then you can read in a simple text file of X and Y positions
using the dialog "File->Read positions...".
The format of this file is flexible and can contain columns of X and Y,
ID, X and Y. X and Y positions are in NDF coordinates, so for FITS files
these are just pixel coordinates. Once read in you can adjust the aperture
size and sky annuli to be the same by selecting "Options->Keep apertures
same size" and then using the usual controls.


<h3>Changing the frame zero point (magnitudes only)</h3>
<p>Just type in the frame zero point into the entry window and press
return. All the existing apertures will now be re-measured.

<h3>Setting the image exposure time</h3>
<p>The easiest way to set the exposure time (so you can normalize all
your observations to unit flux) is to just enter the exposure time in
seconds in the "Exposure time/qualifier:" entry, (found under the
"Parameters" tab) after making sure that the "Exposure time source:"
menu is set to "simple constant".

<p>Note that the exposure time is just used as a ratio to scale the
intensities, so using seconds is only a convenience.

<p>If your data have their exposure time set in the image headers
(e.g. FITS-like headers), then you can use this instead. Just select
"FITS keyword" and enter the header item name in the "Exposure
time/qualifier" entry.

<h3>Controlling the centroiding, noise characteristics, sky estimators...</h3>
<p>The aperture photometry is actually performed by the PHOTOM program
AUTOPHOTOM. This is described in SUN/45. All the additional parameters
that define the conversion factor from data units to photons, any bias
in the data and modify the way that the sky background is estimated
can be set by selecting the "Parameters" tab. You should read SUN/45
(use the command <tt>showme sun45</tt> to view the on-line
documentation) to understand these parameters.

<p><b>WARNING:</b> the error estimates in the measurements will be
wrong unless you set the image bias and data units to photons
conversion factor correctly, this includes when measuring errors
using sky variance. When you have no information about these values
select "gaussian sky", which should give an upper error limit based on 
the variation in sky values.

<h3>Understand the results for an aperture</h3>
<p>The results shown for an aperture have the following meanings:
<dl>
<dt>Aperture index
<dd>just a sequence number to distinguish measurements
<dt>X position      
<dd>before a making a measurement, the position of the 
<dt>Y position
<dd>center of the aperture, after making the measurement, the
centroided position -- if you've selected centroiding
<dt>Magnitude       
<dd>the magnitude of the object, this is sky subtracted and scaled
using the photons per data unit and exposure factors
<dt>Magnitude error 
<dd>error in the magnitude, the error is derived using either the sky
variance, photon statistics, or the data variance, if you are using
photon statistics or sky variance then a good knowledge of the photons
per data unit is required, photon statistics also requires that you know
the bias level, use a gaussian estimate if you don't know any
conversion factors (or they don't make sense and you don't have 
a data variance component)
<dt>Sky value       
<dd>the estimated sky, either derived from the annulus, or detached
sky regions, or a constant, scaled by photons per data unit factor
<dt>Sum in aperture
<dd>sum of object data counts in aperture, scaled by the photon per
data unit value and the exposure factors (excludes any sky contribution)
<dt>Error code      
<dd>status of measurement:
<dl> 
<dt><b>OK</b><dd> measurement has no problems
<dt><b>B</b> <dd>one or more pixels in aperture is bad 
<dt><b>S</b> <dd>one or more pixels in aperture is saturated
<dt><b>E</b> <dd>the object aperture intersects the edge of the data array
<dt><b>?</b> <dd>there are other problems with the measurement
</dl>
</dl>
</body>
</html>
