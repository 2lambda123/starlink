#!/bin/sh
#
# E.S.O. - VLT project
#
# "@(#) $Id: rtd.sh.in,v 1.13 1998/07/28 21:23:27 abrighto Exp $" 
#
# This script is used to start Tcl/Tk applications.
#
# To install a Tcl/Tk script, make a soft link to this file
# in the same directory. This script will determine
# the name of the Tcl source file to load based on the name
# of the link and the environment variables.
#
#  who      when     what
# -------- -------- ------------------
# abrighto 11/10/95 created 
# pbiereic 20/01/97 TCL_LIBRARY, TK_LIBRARY, BLT_LIBRARY
# abrighto 26/11/97 modified to use astrotcl and tclutil pkgs

# set basic shared library runtime search path (see also below)
@LD_VARNAME@="@LIBDIR@:@TCLTK_ROOT@/lib:@TCLTK_ROOT@/lib/itcl:@XLIBDIR@:${@LD_VARNAME@}"

# when running from the source dir, set different env for local test
test -f ../demos/rtd_env.sh && . ../demos/rtd_env.sh

# During development, set TCLUTIL_LIBRARY to your local tclutil/library
# directory, otherwise the tcl/tk scripts are taken from the installed
# versions
if [ -z "$TCLUTIL_LIBRARY" ]
then
  # use the installed Tcl/Tk files and shared library
  TCLUTIL_LIBRARY=@TCLUTIL_LIBRARY@; export TCLUTIL_LIBRARY
else
  # use the local development Tcl/Tk files and shared library
  @LD_VARNAME@="$TCLUTIL_LIBRARY/../..:${@LD_VARNAME@}"
fi

# During development, set ASTROTCL_LIBRARY to your local astrotcl/astrotcl/library
# directory, otherwise the tcl/tk scripts are taken from the installed
# versions
if [ -z "$ASTROTCL_LIBRARY" ]
then
  # use the installed Tcl/Tk files and shared library
  ASTROTCL_LIBRARY=@ASTROTCL_LIBRARY@; export ASTROTCL_LIBRARY
else
  # use the local development Tcl/Tk files and shared library
  @LD_VARNAME@="$ASTROTCL_LIBRARY/../..:${@LD_VARNAME@}"
fi

# During development, set RTD_LIBRARY to your local rtd/rtdimg/library
# directory, otherwise the tcl/tk scripts are taken from the installed
# versions
if [ -z "$RTD_LIBRARY" ]
then
  # use the installed Tcl/Tk files and shared library
  RTD_LIBRARY=@RTD_LIBRARY@; export RTD_LIBRARY
else
  # use the local development Tcl/Tk files and shared library
  @LD_VARNAME@="$RTD_LIBRARY/../..:${@LD_VARNAME@}"
fi

# name of program to run
prog=`basename $0`

# wish binary to use
WISH=$RTD_LIBRARY/../bin/rtdimage_wish
test -f $WISH || WISH=$RTD_LIBRARY/../../bin/rtdimage_wish

# set environment variables for packages
if [ -d "@TCL_LIBRARY@" ]
then
  TCL_LIBRARY=@TCL_LIBRARY@
  export TCL_LIBRARY
fi
 
if [ -d "@TK_LIBRARY@" ]
then
  TK_LIBRARY=@TK_LIBRARY@
  export TK_LIBRARY
fi
 
if [ -d "@BLT_LIBRARY@" ]
then
  BLT_LIBRARY=@BLT_LIBRARY@
  export BLT_LIBRARY
fi

# start an interactive shell
if [ "$prog" = "rtd.sh" ]
then exec $WISH "$@"
fi

# determine which tcl file to start
file=$RTD_LIBRARY/demos/$prog.tcl

# be careful about passing arguments with embedded spaces
if [ "$#" = "0" ]
then
  exec $WISH $file
fi

exec $WISH $file "$@" -visual pseudocolor
