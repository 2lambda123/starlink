# E.S.O. - VLT project/ESO Archive
# "@(#) $Id: Makefile.in,v 1.2 2005/02/02 01:43:03 brighton Exp $"
#
# Makefile.in
#
# This file is processed by configure to produce the actual Makefile.
#
# who             when       what
# --------------  ---------  ---------------------------------------------
# Allan Brighton  08 Mar 96  Created
# pbiereic        17/02/03   New tRtd
# ------------------------------------------------------------------------

SRCS 		=  tRtd.C

OBJS 		=  tRtd.o tImageEvent.o

PROGS 		=  tRtd tImageEvent

INCLUDES	= -I../../rtdevt/include \
                  -I../../rtilib/include \
                  -I../../rtdimg/include \
                  -I ../../../astrotcl/imageio/include \
                  $(BUILD_INCLUDES) \
                  -I$(TOPDIR)/include/tclutil \
                  -I$(TOPDIR)/include/astrotcl

CC_SWITCHES	= $(DEFINES) $(INCLUDES) $(CFLAGS)

LIBRARIES       = ../../rtdevt/lib/librtdImgEvt.a \
		  $(TCLUTIL_LIB_STATIC)
LIB_STDCPP      = @LIB_STDCPP@

TCL_APPS        = tRtdImage tRtdImageCut tRtdImagePick tRtdImageCtrl \
	          tRtdImageGraphics tRtdImageSpectrum Test


do_all: tRtd tcl_apps
	@chmod +x ./tRtdEndian.tcl

test: $(PROGS)

# create the startup script for starting the Tcl applications
tcl_apps:
	@for i in $(TCL_APPS); do \
	    rm -f $$i; \
	    echo '#!/bin/sh' > $$i; \
	    cat ../demos/rtd.sh | awk '! /^ *#/ { if (length()) { print "#\\"; print }}' >> $$i; \
	    echo '# --------------------------------------------------' >> $$i; \
	    cat $$i.tcl | awk '! /^ *#/' >> $$i; \
	    chmod +x $$i ; \
	done

do_install:
	$(INSTALL) tRtd $(BINDIR)

do_clean: 
	$(RM) $(PROGS) $(OBJS) $(TCL_APPS)

tRtd: $(LIBRARIES) tRtd.o tRtdEvt.o tRtdEvtData.o
	$(CXX) $(CC_SWITCHES) -o $@ tRtd.o -lm tRtdEvt.o tRtdEvtData.o \
	../../rtdevt/lib/librtdImgEvt.a ../../../astrotcl/imageio/lib/libimageio.a \
	../../../tclutil/libtclutil.a ../../../tclutil/util/lib/libutil.a \
	../../../astrotcl/wcslib/lib/libwcslib.a ../../../astrotcl/compress/lib/libcompress.a \
	@LIBS@ $(LIB_STDCPP)

tImageEvent: $(LIBRARIES) tImageEvent.o 
	$(CXX) $(CC_SWITCHES) -o $@ $@.o $(LIBRARIES) @LIBS@ $(LIB_STDCPP)

include ../../makefile.mk
include ../../depend.mk










