# E.S.O. - VLT project 
# "@(#) $Id: Makefile.in,v 1.2 2005/02/02 01:43:03 brighton Exp $"
#
# ------------------------------------------------------------------------
# 	Makefile for rtdImgEvt library
# ------------------------------------------------------------------------

SRCS 		=  rtdClient.c rtdServer.C rtdSERVERCPP.C rtdCLNT.C rtdSem.c rtdImageEvent.c \
		   rtdCubeDisplay.c rtdLOG.C

OBJS 		=  rtdImageEvent.o rtdSem.o
RTD_SERVER_OBJS	=  rtdServer.o rtdSERVERCPP.o rtdCLNT.o rtdLOG.o

PROGS           =  ../bin/rtdServer
DEMOS           =  ../bin/rtdClient ../bin/rtdCubeDisplay

libname  	= ../lib/librtdImgEvt.a

INCLUDES	= -I../include \
		  $(BUILD_INCLUDES) \
		  -I$(TOPDIR)/include/tclutil

do_all: dirs $(libname) $(PROGS) $(DEMOS)

../bin/rtdServer: $(RTD_SERVER_OBJS)
	$(AT) echo "Building $@ ..." ; \
		$(CXX) $(CC_SWITCHES) -o $@ $(RTD_SERVER_OBJS) $(libname) @LIBS@ @LIB_STDCPP@

../bin/rtdClient: rtdClient.o
	$(AT) echo "Building $@ ..." ; \
		$(CC) $(CC_SWITCHES) -o $@ $? $(libname) @LIBS@

../bin/rtdCubeDisplay: rtdCubeDisplay.o
	$(AT) echo "Building $@ ..." ; \
		$(CC) $(CC_SWITCHES) -o $@ $? $(libname) @LIBS@

$(libname): $(OBJS)
	$(RM) $@
	$(AR) $@ $(OBJS)
	$(RANLIB) $@

do_install: $(libname) $(PROGS) install-dirs $(DEMOS)
	$(INSTALL_DATA) $(libname) $(LIBDIR)
	$(RANLIB) $(LIBDIR)/$(libname)
	for i in $(PROGS); do $(INSTALL) $$i $(BINDIR); done
	for i in $(DEMOS); do $(INSTALL) $$i $(RTD_DIR)/demos; done

dirs:
	@test -d ../lib || mkdir ../lib

install-dirs:
	@for i in $(TOPDIR) $(LIBDIR) $(RTD_DIR) $(RTD_DIR)/demos $(BINDIR) ; do \
	    if test ! -d $$i ; then \
		mkdir $$i ; \
	    fi ; \
	done

do_clean: 
	$(AT)$(RM) $(OBJS) $(PROGS) $(DEMOS) $(libname)

include ../../makefile.mk
include ../../depend.mk

