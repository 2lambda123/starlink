# $Id$

# gaiaInit.tcl - This script generates a mktclapp config file on stdout.

#  Copyright:
#     Copyright (C) 1999-2005 Central Laboratory of the Research Councils.
#     Copyright (C) 2006 Particle Physics & Astronomy Research Council.
#     All Rights Reserved.

#  Licence:
#     This program is free software; you can redistribute it and/or
#     modify it under the terms of the GNU General Public License as
#     published by the Free Software Foundation; either version 2 of the
#     License, or (at your option) any later version.
#
#     This program is distributed in the hope that it will be
#     useful, but WITHOUT ANY WARRANTY; without even the implied warranty
#     of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program; if not, write to the Free Software
#     Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
#     02111-1307, USA

#
# who             when       what
# --------------  ---------  ----------------------------------------
# Peter W. Draper 12 May 99  Created, based on skyCatInit.tcl
proc main {} {
   global argv argc env argv0
   
   if {$argc != 1} {
      puts "usage: gaiaInit.tcl output_file_name"
      exit 1
   }
   set outfile [lindex $argv 0]
   set fd [open $outfile w]
   
   #  Set names of source directories.
   set tcl_library      @TCL_LIBRARY@
   set tk_library       @TK_LIBRARY@
   set itcl_library     @ITCL_LIBRARY@
   set itk_library      @ITK_LIBRARY@
   set tclutil_library  @TCLUTIL_LIBRARY@
   set astrotcl_library @ASTROTCL_LIBRARY@
   set cat_library      @CAT_LIBRARY@
   set rtd_library      @RTD_LIBRARY@
   set skycat_library   @SKYCAT_LIBRARY@
   set gaia_library     @GAIA_BUILD_LIBRARY@
   set iwidgets_library @IWIDGETS_LIBRARY@
   set iscripts_library @IWIDGETS_LIBRARY@/scripts
   set tclx_library     @TCLX_LIBRARY@
   set startcl_library  @STARTCL_LIBRARY@
   
   set srcdirs [list \
                   $tcl_library \
                   $tk_library \
                   $itcl_library \
                   $itk_library \
                   $tclx_library \
                   $iwidgets_library \
                   $iscripts_library \
                   $tclutil_library \
                   $astrotcl_library \
                   $rtd_library \
                   $cat_library \
                   $skycat_library \
                   $startcl_library \
                   $gaia_library]
   
   #  Set location of startup script.
   puts $fd "-main-script \"${gaia_library}/gaiaMain.tcl\""
   
   #  Binary is standalone (only during testing). Stops sourcing of 
   #  external files otherwise.
   # puts $fd "-standalone"
   
   #  Set location of Tcl and Tk.
   puts $fd "-tcl-library \"$tcl_library\""
   puts $fd "-tk-library \"$tk_library\""
   
   #  Name of the Et_AppInit file.
   puts $fd "tkAppInit.C"
   
   #  Now add all the Tcl file from everywhere.
   foreach dir $srcdirs {
      if {[file exists $dir/tclIndex]} {
         puts $fd "-dont-strip-tcl \"$dir/tclIndex\""
      }
      set tclfiles [glob -nocomplain $dir/*.tcl $dir/*.itk $dir/*.itcl]
      foreach file "$tclfiles" {
         puts $fd "-dont-strip-tcl \"$file\""
      }
   }
}
main
exit
