# $Id$
#
# Makefile.in - Makefile for creating gaia standalone executable.
#
# This file is processed by configure to produce the actual Makefile.
#
# who             when       what
# --------------  ---------  ---------------------------------------------
# Peter W. Draper 6-Oct-1997 Created
# ------------------------------------------------------------------------

# C compiler
CC 	     = @CC@

# C++ compiler
CXX          = @CXX@

# -D flags
DEFINES      = -DSHARED=@SHARED@ @TCLUTIL_DEFS@

# other flags to pass to compiler
CFLAGS       = @CXXDEBUGFLAGS@

# install directories
TOPDIR	     = @DESTDIR@
BINDIR       = @BINDIR@
LIBDIR       = @LIBDIR@
RTD_DIR      = @RTD_DIR@

# Include directives for Tcl, Tk, and X include files
TCL_INCLUDE   = @TCLINCSW@
TK_INCLUDE    = @TKINCSW@
X_INCLUDE     = @XINCSW@

# X Libraries
X_LIB        = @XLIBSW@
EXTRA_LIBS   = @LIBS@

# Tk libs
TCLTKLIBS = @ITK_LIB_SPEC@ \
	    @TIX_LIB_SPEC@ \
            @TK_LIB_SPEC@ \
            @BLT_LIB_SPEC@ \
            @TCLX_LIB_SPEC@ \
            @ITCL_LIB_SPEC@ \
            @TCL_LIB_SPEC@

# Tclutil library
TCLUTIL_LIB          = @TCLUTIL_LIB@
TCLUTIL_LIB_STATIC   = @TCLUTIL_LIB_STATIC@

# Astrotcl library
ASTROTCL_LIB         = @ASTROTCL_LIB@
ASTROTCL_LIB_STATIC  = @ASTROTCL_LIB_STATIC@

# Rtd library
RTD_LIB              = @RTD_LIB@
RTD_LIB_STATIC       = @RTD_LIB_STATIC@

# Catalog library
CAT_LIB              = @CAT_LIB@
CAT_LIB_STATIC       = @CAT_LIB_STATIC@

# Skycat libraries
SKYCAT_LIB	     = @SKYCAT_LIB@
SKYCAT_LIB_STATIC    = @SKYCAT_LIB_STATIC@

#  Local GAIA library.
LOCAL_LIBRARY = ../lib/libgaia.a

# info needed for shared libraries (see configure.in or tclConfig.sh
# for an explanation)
SHLIB_CFLAGS=@SHLIB_CFLAGS@
SHLIB_LD=@SHLIB_LD@
SHLIB_SUFFIX=@SHLIB_SUFFIX@
SHLIB_LD_LIBS=@SHLIB_LD_LIBS@
DL_LIBS=@DL_LIBS@
LD_FLAGS=@LD_FLAGS@
LD_SEARCH_FLAGS=@LD_SEARCH_FLAGS@
LIB_RUNTIME_DIR=@LIB_RUNTIME_DIR@

# ------------------------------------------------------------------------
#       Libraries required to link against Fortran source code
#       using a C++ compiler.
# ------------------------------------------------------------------------
F77_LIBS = @F77_LIBS@
TCLADAM  = @DESTDIR@/lib/tclAdam.o
STAR_LIB = @STARLINK@/lib
STAR_INC = @STARLINK@/include
COMPIFL  = @STARLINK@/bin/compifl
#  Define sets of ADAM libraries we need to link against. Note that
#  ast_link and ndf_link must be carefully managed to avoid picking up
#  default AST libraries for errors and graphics.
AST_LIBS = -L$(STAR_LIB) `ast_link -myerr -mygrf`
ADAM_LIBS = -L$(STAR_LIB) `ard_link` `ams_link_adam` `fio_link` `cat_link_adam` `subpar_link_adam` `ndf_link`  -lpda

#  Name of single binary
PROG = bin/gaia_$(SYSTEM)

#  Name of mktclapp converter.
MKTCLAPP = bin/mktclapp

INCLUDES     = $(TK_INCLUDE) $(TCL_INCLUDE) $(X_INCLUDE)

CC_SWITCHES  = $(CFLAGS) $(DEFINES) $(INCLUDES)

# these objects are only needed to make the gaia_wish binary for the demos
OBJECTS      = EtAppInit.o gaiainit.o

INSTALL      = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
RANLIB 	     = @RANLIB@
SHELL 	     = /bin/sh
RM 	     = rm -f
LN 	     = ln -s

# ------------------------------------------------------------------------
all: $(mktclapp) $(PROG)

$(MKTCLAPP): mktclapp.o
	$(CC) -o $(MKTCLAPP) mktclapp.o

$(PROG): $(OBJECTS) FORCE
	@echo "linking \"$(PROG)\"..."
	$(CXX) $(CC_SWITCHES) $(OBJECTS) -o $(PROG)  \
	       $(LD_SEARCH_FLAGS) $(SKYCAT_LIB_STATIC) $(CAT_LIB_STATIC) $(AST_LIBS) \
	       $(RTD_LIB_STATIC) $(ASTROTCL_LIB_STATIC) \
	       $(TCLUTIL_LIB_STATIC) $(TCLADAM) $(LOCAL_LIBRARY) \
	       $(AST_LIBS) $(TCLUTIL_LIB_STATIC) $(ADAM_LIBS) $(TCLTKLIBS) \
	       $(X_LIB) $(EXTRA_LIBS)

install: install-top install-bin

install-top:
	@if test -d $(TOPDIR); then : ; else mkdir $(TOPDIR); fi

install-bin:
	@if test -d $(BINDIR); then : ; else mkdir $(BINDIR); fi
	$(INSTALL) $(PROG) $(BINDIR)

clean:
	$(RM) $(OBJECTS) $(PROG) $(MKTCLAPP)

distclean: clean
	$(RM) Makefile

depend:

man:

.SUFFIXES: .C
.c.o:
	$(CC) -c $(CC_SWITCHES) $<

.C.o:
	$(CXX) -c $(CC_SWITCHES) $<

FORCE:

