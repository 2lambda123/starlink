      SUBROUTINE FCSAVE(SUBCHK)
      LOGICAL SUBCHK
      CHARACTER*40 ITXT
      COMMON/KEEP/FUNS,AS,PS,FLXS,FMX,WSS,INDXS,IRELS,NLS,NPARS,IABST
      COMMON/DAT4/XV,FXV,ARP,WVF,CFLX,IXV,NXV,NPROF
      COMMON/DAT4A/ITXT
      COMMON/DAT5/NDIM,NDI2,NPAR,NUMFIT,NCUR,MAXFC
      COMMON/KERRS/DELBS,DELPS,DSS
      COMMON/DEBUG/NY
      DIMENSION FUNS(20),PS(10,10),FLXS(20,10),FMX(10),WSS(10)
      DIMENSION AS(80,10,2),INDXS(80,10,2),IRELS(80,10,2),NLS(20)
      DIMENSION IABST(20),NPARS(10)
      DIMENSION DELBS(80,10),DELPS(10,10),DSS(20,10)
      DIMENSION XV(5,1000),FXV(5,1000),ARP(5),IXV(5),NXV(5),ITXT(5)
      DIMENSION WVF(5),CFLX(5)
      SAVE /KERRS/
      SUBCHK=.TRUE.
      WRITE(34,ERR=100) NUMFIT
      DO J=1,NUMFIT
        WRITE(34,ERR=100) ((AS(I,J,K),INDXS(I,J,K),IRELS(I,J,K),
     :                     K=1,2),I=1,80)
        WRITE(34,ERR=100) (FLXS(I,J),I=1,20)
        WRITE(34,ERR=100)  (PS(I,J),I=1,10)
        WRITE(34,ERR=100) FUNS(J),FMX(J),IABST(J),NPARS(J),NLS(J)
        WRITE(34,ERR=100) (DELBS(I,J),I=1,80)
        WRITE(34,ERR=100) (DELPS(I,J),I=1,10)
        WRITE(34,ERR=100) (DSS(I,J),I=1,20)
      ENDDO
      IF(NY.GT.0) PRINT *,'NPROF',NPROF
      WRITE(34,ERR=100) NPROF
      IF(NPROF.NE.0) THEN
        DO J=1,NPROF
          WRITE(34,ERR=100) ARP(J),WVF(J),CFLX(J),
     :                      IXV(J),NXV(J),ITXT(J)
          WRITE(34,ERR=100) (XV(J,K),FXV(J,K),K=1,1000)
        ENDDO
      ENDIF
      DO J=1,NUMFIT
        WRITE(34,ERR=100) WSS(J)
      ENDDO
      RETURN
  100 SUBCHK=.FALSE.
      RETURN
      END
