      SUBROUTINE ELFINV(A,N)
      DIMENSION A(70,70),PIVOT(70),IPIVOT(70),INDEX(70,2)
COLD  SUBROUTINE ELFINV  (N)
COLD  COMMON/DINV/ A(&L 1,&L 1)
COLD  DIMENSION              PIVOT(&L 1),IPIVOT(&L 1),INDEX(&L 1,2)
C     INITIALIZATION
      IF(N.EQ.1) GO TO 741
   15 DO 20 J = 1,N
   20 IPIVOT(J) = 0
   30 DO 550 I = 1,N
C     SEARCH FOR PIVOT ELEMENT
   40 AMAX = 0.0
   45 DO 105 J = 1,N
   50 IF(IPIVOT(J)-1) 60,105,60
   60 DO 100 K = 1,N
   70 IF(IPIVOT(K)-1) 80,100,740
   80 IF(ABS(AMAX)-ABS(A(J,K)))85,100,100
   85 IROW = J
   90 ICOLUM=K
   95 AMAX=A(J,K)
  100 CONTINUE
  105 CONTINUE
  110 IPIVOT(ICOLUM)=IPIVOT(ICOLUM)+1
C     INTERCHANGE ROWS TO PUT PIVOT ELEMENT ON DIAGONAL
  130 IF(IROW-ICOLUM) 150,260,150
  150 DO 200 L = 1,N
  160 SWAP = A(IROW,L)
  170 A(IROW,L) = A(ICOLUM,L)
  200 A(ICOLUM,L) = SWAP
  260 INDEX(I,1) = IROW
  270 INDEX(I,2)=ICOLUM
  310 PIVOT(I) =A(ICOLUM,ICOLUM)
C     DIVIDE PIVOT ROW BY PIVOT ELEMENT
  330 A(ICOLUM,ICOLUM) = 1.0
  340 DO 350 L= 1,N
  350 A(ICOLUM,L) = A(ICOLUM,L)/PIVOT(I)
  380 DO 550 L1 = 1,N
  390 IF(L1-ICOLUM) 400,550,400
  400 T = A(L1,ICOLUM)
  420 A(L1,ICOLUM) = 0.0
  430 DO 450 L = 1,N
  450 A(L1,L) = A(L1,L)-A(ICOLUM,L)*T
  550 CONTINUE
C     INTERCHANGE COLUMNS
  600 DO 710 I = 1,N
  610 L = N+1-I
  620 IF(INDEX(L,1)-INDEX(L,2)) 630,710,630
  630 JROW = INDEX(L,1)
  640 JCOLUM = INDEX(L,2)
  650 DO 705 K = 1,N
  660 SWAP = A(K,JROW)
  670 A(K,JROW) = A(K,JCOLUM)
  700 A(K,JCOLUM) = SWAP
  705 CONTINUE
  710 CONTINUE
  740 RETURN
  741 A(1,1) = 1./A(1,1)
      RETURN
      END
