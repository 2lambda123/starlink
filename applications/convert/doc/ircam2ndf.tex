\newpage
\sstroutine{
   IRCAM2NDF
}{
   Converts an IRCAM data file to a series of NDFs
}{
   \sstdescription{
      This applications converts an HDS file in the IRCAM format listed
      in IRCAM User Note 11 to one or more NDFs.  See the Notes for a
      detailed list of the rules of the conversion.
   }
   \sstusage{
      ircam2ndf in prefix obs [config]
   }
   \sstparameters{
      \sstsubsection{
         CONFIG = LITERAL (Read)
      }{
         The choice of data array to place in the NDF.  It can have one
         of the following configuration values:
            \begin{itemize}
            \item {\tt "STARE"} --- the image of the object or sky;
            \item {\tt "CHOP"} --- the chopped image of the sky;
            \item {\tt "KTCSTARE"} --- the electronic pedestal or bias associated
                           with the stare image of the object or sky;
            \item{\tt "KTCCHOP"} --- the electronic pedestal or bias associated
                           with the chopped image of the sky.
            \end{itemize}
         Note that at the time of writing chopping has not been
         implemented for IRCAM.  For practical purposes CONFIG=\dqt{STARE}
         should be used.  The suggested default is the current value.
         {\tt ["STARE"]}
      }
      \sstsubsection{
         FMTCNV = \_LOGICAL (Read)
      }{
         This specifies whether or not format conversion may occur.
         If FMTCNV is {\tt FALSE}, the data type of the data array in the NDF
         will be the same as that in the IRCAM file, and there is no
         scale factor and offset applied.  If FMTCNV is {\tt TRUE}, whenever
         the IRCAM observation has non-null scale and offset values,
         the observation data array will be converted to type \_REAL in
         the NDF, and the scale and offset applied to the input data
         values to give the `true' data values.  A null scale factor is
         1 and a null offset is 0. {\tt [FALSE]}
      }
      \sstsubsection{
         IN = IRCAM (Read)
      }{
         The name of the input IRCAM file to convert to NDFs.  The
         suggested value is the current value.
      }
      \sstsubsection{
         OBS()  = LITERAL (Read)
      }{
         A list of the observation numbers to be converted into NDFs.
         Observations are numbered consecutively from 1 up to the
         actual number of observations in the IRCAM file.  Single
         observations or a set of adjacent observations may be
         specified, {\it e.g.}\ entering {\tt [4,6-9,12,14-16]} will read
         observations 4,6,7,8,9,12,14,15,16.  (Note that the brackets
         are required to distinguish this array of characters from a
         single string including commas.  The brackets are unnecessary
         when there is only one item.)

         If you wish to extract all the observations enter the wildcard
         {\tt $*$}.  {\tt 5-$*$} will read from 5 to the last observation.  The
         processing will continue until the last observation is
         converted.  The suggested value is the current value.
      }
      \sstsubsection{
         PREFIX = LITERAL (Read)
      }{
         The prefix of the output NDFs.  The name of an NDF is the
         prefix followed by the observation number.  The suggested
         value is the current value.
      }
   }
   \sstexamples{
      \sstexamplesubsection{
         ircam2ndf ircam\_27aug89\_1cl rhooph obs=$*$
      }{
         This converts the IRCAM data file called {\tt ircam\_27aug89\_1cl} into
         a series of NDFs called rhooph1, rhooph2 {\it etc.}\  
         There is no format conversion applied.
      }
      \sstexamplesubsection{
         ircam2ndf ircam\_27aug89\_1cl rhooph [32,34-36] fmtcnv
      }{
         This converts four observations in the IRCAM data file called
         {\tt ircam\_27aug89\_1cl} into NDFs called rhooph32, 
         rhooph34, rhooph35, rhooph36.  The scale and offset
         are applied.
      }
      \sstexamplesubsection{
         ircam2ndf in=ircam\_04nov90\_1c config="KTC" obs=5 prefix=bias
      }{
         This converts the fifth observation in the IRCAM data file
         called {\tt ircam\_04nov90\_1c.sdf} into an NDF called bias5
         containing the electronic pedestal in its data array.  There is no 
         format conversion applied.
      }
   }
   \sstnotes{
      The rules for the conversion of the various components are as
      follows:
      \begin{center}
      \begin{tabular}{|lcl|p{35mm}|}
      \hline 
      \multicolumn{1}{|l}{IRCAM file} & & \multicolumn{1}{l}{NDF} &
      \multicolumn{1}{|c|}{Comments} \\ \hline
      .OBS.PHASEA.DATA\_ARRAY & $\Rightarrow$ &  .DATA\_ARRAY & 
          when parameter CONFIG={\tt "STARE"} \\
      .OBS.PHASEB.DATA\_ARRAY & $\Rightarrow$ &  .DATA\_ARRAY &
          when parameter CONFIG={\tt "CHOP"} \\
      .OBS.KTCA.DATA\_ARRAY   & $\Rightarrow$ &  .DATA\_ARRAY &
          when parameter CONFIG={\tt "KTCSTARE"} \\
      .OBS.KTCB.DATA\_ARRAY   & $\Rightarrow$ &  .DATA\_ARRAY &
          when parameter CONFIG={\tt "KTCCHOP"} \\
      & & & \\
      .OBS.DATA\_LABEL        & $\Rightarrow$ &  .LABEL & \\
      .OBS.DATA\_UNITS        & $\Rightarrow$ &  .UNITS & \\
      .OBS.TITLE              & $\Rightarrow$ &  .TITLE &
          If .OBS.TITLE is a blank string, OBS.DATA\_OBJECT is copied
          to the NDF title instead. \\
      & & & \\
      .OBS.AXIS1\_LABEL       & $\Rightarrow$ &  .AXIS(1).LABEL & \\
      .OBS.AXIS2\_LABEL       & $\Rightarrow$ &  .AXIS(2).LABEL & \\
      .OBS.AXIS1\_UNITS       & $\Rightarrow$ &  .AXIS(1).UNITS & \\
      .OBS.AXIS2\_UNITS       & $\Rightarrow$ &  .AXIS(2).UNITS & \\
      \multicolumn{3}{|p{111mm}|}{
      .GENERAL.INSTRUMENT.PLATE\_SCALE 
          becomes the increment between the axis centres, with co-ordinate
          (0.0,0.0) located at the image centre.  The NDF axis units both
          become {\tt "arcseconds"}. } & \\
      & & & \\
      .GENERAL               & $\Rightarrow$ &  .MORE.IRCAM.GENERAL & \\
      .GENERAL.x             & $\Rightarrow$ &  .MORE.IRCAM.GENERAL.x & \\
      .GENERAL.x.y           & $\Rightarrow$ &  .MORE.IRCAM.GENERAL.x.y & \\
      & & & \\
      .OBS.x                 & $\Rightarrow$ &  .MORE.IRCAM.OBS.x &
          This excludes the components of OBS already listed above and
          DATA\_BLANK. \\ \hline
      \end{tabular}
      \end{center}

      \sstitemlist{

         \sstitem
         The data types of the IRCAM GENERAL structures have not been
         propagated to the NDF IRCAM extensions, because it would violate
         the rules of SGP/38.  In the IRCAM file these all have the same
         type STRUCTURE.  The new data types are as follows:

      \begin{center}
      \begin{tabular}{|l|l|}
      \hline 
      \multicolumn{1}{|c|}{Extension Name} & \multicolumn{1}{c|}{Data Type} \\ \hline
      IRCAM.GENERAL & IRCAM\_GENERAL \\
      IRCAM.GENERAL.INSTRUMENT & IRCAM\_INSTRUM \\
      IRCAM.GENERAL.ID & IRCAM\_ID \\
      IRCAM.GENERAL.TELESCOPE & IRCAM\_TELESCOPE \\ \hline
      \end{tabular}
      \end{center}

         \sstitem
         Upon completion the number of observations
         successfully converted to NDFs is reported.
      }
   }
   \sstdiytopic{
      Bad-pixel Handling
   }{
      Elements of the data array equal to the IRCAM component
      .OBS.DATA\_BLANK are replaced by the standard bad value.
   }
   \sstimplementationstatus{
      \sstitemlist{

         \sstitem
         The data array in the NDF is in the primitive form.

         \sstitem
         The application aborts if the data array chosen by parameter
         CONFIG does not exist in the observation.
      }
   }
}

