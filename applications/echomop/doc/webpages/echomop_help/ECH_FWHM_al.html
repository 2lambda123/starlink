<HTML>
<HEAD>
<TITLE>
ECHOMOP Help: ECH_FWHM_al.
</TITLE>
</HEAD>

<BODY>
<I>ECHOMOP-Online HELP</I>
<HR>
<B><A HREF="ECH_FWHM.html">Previous topic</A></B>
 | <B><A HREF="echomop.html">ECHOMOP HELP page</A></B>
 | <B><A HREF="http://www.star.ucl.ac.uk/~mjc/echelle/">Starlink EDR home</A></B>
 | <B><A HREF="http://star-www.rl.ac.uk/documentation.html">Starlink Docs</A></B>
<HR><H2>Algorithm</H2><HR>
<P>
<PRE WIDTH=72>
 Determine which orders to use, ignoring top/bottom if possible
 Loop through each available order
   If a good trace polynomial is available for this order then
     Calculate the order trace
     Initialise spectrum arrays
     Loop through pixels on order +- 1 y pixel
        Calculate y pixel address and sample reference spectrum
        Take 3 pixel (in y) average spectrum too
     End loop
     Loop through average spectrum looking for local peaks (3 pixels wide)
      If a local peak then
        Get peak intensity from non-averaged version of spectrum
        Estimate centre of peak
        If centre is within +- 2 pixels of the peak pixel then
          Add subsampled 'centered' copy of reference spectrum into the
                  accumulated profile array
        End if
      End if
     End loop
   End if
 End loop
 Calculate the median intensity of the composite profile
 Step away from peak until intensity falls below median + peak-median/2
 Calculate corresponding FWHM
 Default value to 1.0 if calculated value is less than 1
 Plot a graph of composite profile
</PRE>
<P>
<P>
<HR>
<B><A HREF="ECH_FWHM.html">Previous topic</A></B>
 | <B><A HREF="echomop.html">ECHOMOP HELP page</A></B>
 | <B><A HREF="http://www.star.ucl.ac.uk/~mjc/echelle/">Starlink EDR home</A></B>
 | <B><A HREF="http://star-www.rl.ac.uk/documentation.html">Starlink Docs</A></B>
<P>
<ADDRESS>
Martin Clayton<BR>
<A HREF="mailto:mjc@star.ucl.ac.uk">mjc@star.ucl.ac.uk</A><BR>
Mon Dec  4 15:45:45 1995
</ADDRESS>
</BODY>
</HTML>
