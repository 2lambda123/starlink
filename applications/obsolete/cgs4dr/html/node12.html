<HEAD>
<TITLE> Eliminating Data with Bad Pixel Masks</TITLE>
</HEAD>
<BODY  BGCOLOR=#F0EBD0>
<P><CENTER><IMG ALIGN=CENTER SRC=hline.gif><P>
<MAP NAME=cgs4map>
<AREA SHAPE=rect COORDS="32,126,138,155"  HREF="node13.html">
<AREA SHAPE=rect COORDS="143,126,252,155" HREF="node10.html">
<AREA SHAPE=rect COORDS="258,126,365,155" HREF="node1.html">
<AREA SHAPE=default HREF="sun27.html">
</MAP>
<IMG ALIGN=CENTER SRC=cgs4map.gif USEMAP="#cgs4map">
<P>
<P><IMG ALIGN=CENTER SRC=hline.gif><P></CENTER>
<H1>Eliminating Data with Bad Pixel Masks</H1>
<P>
A bad pixel mask is a data frame that indicates which pixels on the
detector array are good and which bad. It may be used to mask off faulty
detectors. Normally the mask contains 0 to indicate good, and 1 to
indicate bad. It should be the same size as the area of the data array
read by the data acquisition system. Bad pixel masks are held in the $cgs4_masks/ directory.
<P>
Besides flagging faulty detectors, a bad pixel mask can also be used for
masking off un-illuminated areas at the edge of the detector array.
<P>
A bad pixel mask can be created by the software using one of three
methods:
<P>
<OL><LI> By setting all the data values lying outside a given range to bad.
 Some sample data are plotted as a histogram, and the required range is 
 selected using a cursor. This is called `thresholding'.
 <LI> By setting all the pixels outside a given window on the detector 
 array to bad.
 <LI> By thresholding an error array.
</OL>
<P>
Masks generated by any method may be combined together.
<P>
The data reduction system can change masks by responding to a 
`DRMASK <em> maskname</em>' command entered into the data reduction queue.
There is also an option to specify no mask at all (#).
<P>
Bad pixel masks can be any size or shape. When a mask is created, it
assumes the same size and shape as the data from which it was created. The
size and shape of the mask created by windowing can also be specified. Of
course, allowing masks to be any size means there is a chance that the
wrong type of mask may be specified when reducing some data. The data
reduction system will check the bad pixel mask against each integration
being reduced to ensure it is the right size and will report if it is not.
<P>
Portable-CGS4DR is shipped with several bad pixel masks specific to the
current arrays:
<P>
<BLOCKQUOTE>
<DL><DT><i> fpa61</i>
<DD> - Masks the known dead, hot and variable pixels for the 
58 x 62 InSb array in CGS4.
<DT><i> fpa61_lc</i>
<DD> - To be used with the CGS4 long focal length camera 
 observations when the whole array is illuminated.
<DT><i> fpa61_75</i>
<DD> - To be used with the CGS4 short focal length camera
 observations and the 75 or 150 lines per millimetre gratings.
<DT><i> alice_fpa42</i>
<DD> - Masks the known dead, hot and variable pixels 
for the InSb 256x256 array in IRCAM3.
<DT><i> fpa46_short</i>
<DD> - Masks the known dead, hot and variable pixels 
for the InSb 256x256 array in CGS4 using the short camera.
<P>
</DL>
</BLOCKQUOTE>
<P>
For the echelle, it is better to make your own windows as the illuminated area
is a strong function of the grating angle.
<P>
Note that there are problems with pixel conventions when manipulating
masks. Some packages use the Starlink pixel convention and some the Figaro
convention which differ by 0.5 in each direction. Combining masks can lead
to errors. The usual way around this problem is to use the Figaro
functions XCSUB and YCSUB to adjust to the appropriate origin. Portable-CGS4DR conforms to the Figaro pixel convention where the data is centered on the
half-integer values <em> i.e.</em> the origin is at (0.5,0.5).
<P>
<HR><P>
<A HREF="mailto:pnd@jach.hawaii.edu">Comments?</A>
</BODY>
