\documentclass[twoside,11pt]{article}

% ? Specify used packages
% \usepackage{graphicx}        %  Use this one for final production.
% \usepackage[draft]{graphicx} %  Use this one for drafting.
% ? End of specify used packages

\pagestyle{myheadings}

% -----------------------------------------------------------------------------
% ? Document identification
% Fixed part
\newcommand{\stardoccategory}  {Starlink User Note}
\newcommand{\stardocinitials}  {SUN}
\newcommand{\stardocsource}    {sun\stardocnumber}
\newcommand{\stardoccopyright} 
{Copyright \copyright\ 2000 Council for the Central Laboratory of the Research Councils}

% Variable part - replace [xxx] as appropriate.
\newcommand{\stardocnumber}    {234.1}
\newcommand{\stardocauthors}   {R.T.Platon}
\newcommand{\stardocdate}      {22 September 2000}
\newcommand{\stardoctitle}     {ONE -- Odds and Ends Library}
\newcommand{\stardocversion}   {Version 1.0}
\newcommand{\stardocmanual}    {User's Guide}
\newcommand{\stardocabstract}  {
This library is a set of Fortran and C routines
of a general nature and usefulness,
which are not suitable for inclusion in other more focussed libraries.
}
% ? End of document identification
% -----------------------------------------------------------------------------

% +
%  Name:
%     sun234.tex
%
%  Purpose:
%     This is a description of the Odds & Ends library
%
%  Authors:
%     RTP: Roy Platon (STARLINK, RAL)
%
%  History:
%      2-AUG-2000 (RTP):
%        Original version, based on Template (see SUN199).
%
% -

\newcommand{\stardocname}{\stardocinitials /\stardocnumber}
\markboth{\stardocname}{\stardocname}
\setlength{\textwidth}{160mm}
\setlength{\textheight}{230mm}
\setlength{\topmargin}{-2mm}
\setlength{\oddsidemargin}{0mm}
\setlength{\evensidemargin}{0mm}
\setlength{\parindent}{0mm}
\setlength{\parskip}{\medskipamount}
\setlength{\unitlength}{1mm}
\newcommand{\noteroutine}[2]{\textbf{#1}\hspace*{\fill}\nopagebreak \\
                             \hspace*{3em}\emph{#2}\hspace*{\fill}\par}

% -----------------------------------------------------------------------------
%  Hypertext definitions.
%  ======================
%  These are used by the LaTeX2HTML translator in conjunction with star2html.

%  Comment.sty: version 2.0, 19 June 1992
%  Selectively in/exclude pieces of text.
%
%  Author
%    Victor Eijkhout                                      <eijkhout@cs.utk.edu>
%    Department of Computer Science
%    University Tennessee at Knoxville
%    104 Ayres Hall
%    Knoxville, TN 37996
%    USA

%  Do not remove the %begin{latexonly} and %end{latexonly} lines (used by 
%  LaTeX2HTML to signify text it shouldn't process).
%begin{latexonly}
\makeatletter
\def\makeinnocent#1{\catcode`#1=12 }
\def\csarg#1#2{\expandafter#1\csname#2\endcsname}

\def\ThrowAwayComment#1{\begingroup
    \def\CurrentComment{#1}%
    \let\do\makeinnocent \dospecials
    \makeinnocent\^^L% and whatever other special cases
    \endlinechar`\^^M \catcode`\^^M=12 \xComment}
{\catcode`\^^M=12 \endlinechar=-1 %
 \gdef\xComment#1^^M{\def\test{#1}
      \csarg\ifx{PlainEnd\CurrentComment Test}\test
          \let\html@next\endgroup
      \else \csarg\ifx{LaLaEnd\CurrentComment Test}\test
            \edef\html@next{\endgroup\noexpand\end{\CurrentComment}}
      \else \let\html@next\xComment
      \fi \fi \html@next}
}
\makeatother

\def\includecomment
 #1{\expandafter\def\csname#1\endcsname{}%
    \expandafter\def\csname end#1\endcsname{}}
\def\excludecomment
 #1{\expandafter\def\csname#1\endcsname{\ThrowAwayComment{#1}}%
    {\escapechar=-1\relax
     \csarg\xdef{PlainEnd#1Test}{\string\\end#1}%
     \csarg\xdef{LaLaEnd#1Test}{\string\\end\string\{#1\string\}}%
    }}

%  Define environments that ignore their contents.
\excludecomment{comment}
\excludecomment{rawhtml}
\excludecomment{htmlonly}

%  Hypertext commands etc. This is a condensed version of the html.sty
%  file supplied with LaTeX2HTML by: Nikos Drakos <nikos@cbl.leeds.ac.uk> &
%  Jelle van Zeijl <jvzeijl@isou17.estec.esa.nl>. The LaTeX2HTML documentation
%  should be consulted about all commands (and the environments defined above)
%  except \xref and \xlabel which are Starlink specific.

\newcommand{\htmladdnormallinkfoot}[2]{#1\footnote{#2}}
\newcommand{\htmladdnormallink}[2]{#1}
\newcommand{\htmladdimg}[1]{}
\newcommand{\hyperref}[4]{#2\ref{#4}#3}
\newcommand{\htmlref}[2]{#1}
\newcommand{\htmlimage}[1]{}
\newcommand{\htmladdtonavigation}[1]{}

\newenvironment{latexonly}{}{}
\newcommand{\latex}[1]{#1}
\newcommand{\html}[1]{}
\newcommand{\latexhtml}[2]{#1}
\newcommand{\HTMLcode}[2][]{}

%  Starlink cross-references and labels.
\newcommand{\xref}[3]{#1}
\newcommand{\xlabel}[1]{}

%  LaTeX2HTML symbol.
\newcommand{\latextohtml}{\LaTeX2\texttt{HTML}}

%  Define command to re-centre underscore for Latex and leave as normal
%  for HTML (severe problems with \_ in tabbing environments and \_\_
%  generally otherwise).
\renewcommand{\_}{\texttt{\symbol{95}}}

% -----------------------------------------------------------------------------
%  Debugging.
%  =========
%  Remove % on the following to debug links in the HTML version using Latex.

% \newcommand{\hotlink}[2]{\fbox{\begin{tabular}[t]{@{}c@{}}#1\\\hline{\footnotesize #2}\end{tabular}}}
% \renewcommand{\htmladdnormallinkfoot}[2]{\hotlink{#1}{#2}}
% \renewcommand{\htmladdnormallink}[2]{\hotlink{#1}{#2}}
% \renewcommand{\hyperref}[4]{\hotlink{#1}{\S\ref{#4}}}
% \renewcommand{\htmlref}[2]{\hotlink{#1}{\S\ref{#2}}}
% \renewcommand{\xref}[3]{\hotlink{#1}{#2 -- #3}}
%end{latexonly}
% -----------------------------------------------------------------------------
% ? Document specific \newcommand or \newenvironment commands.
\input{/star/docs/sst}
% ? End of document specific commands
% -----------------------------------------------------------------------------
%  Title Page.
%  ===========
\renewcommand{\thepage}{\roman{page}}
\begin{document}
\thispagestyle{empty}

%  Latex document header.
%  ======================
\begin{latexonly}
   CCLRC / \textsc{Rutherford Appleton Laboratory} \hfill \textbf{\stardocname}\\
   {\large Particle Physics \& Astronomy Research Council}\\
   {\large Starlink Project\\}
   {\large \stardoccategory\ \stardocnumber}
   \begin{flushright}
   \stardocauthors\\
   \stardocdate
   \end{flushright}
   \vspace{-4mm}
   \rule{\textwidth}{0.5mm}
   \vspace{5mm}
   \begin{center}
   {\Huge\textbf{\stardoctitle \\ [2.5ex]}}
   {\LARGE\textbf{\stardocversion \\ [4ex]}}
   {\Huge\textbf{\stardocmanual}}
   \end{center}
   \vspace{5mm}

% ? Add picture here if required for the LaTeX version.
%   e.g. \includegraphics[scale=0.3]{filename.ps}
% ? End of picture

% ? Heading for abstract if used.
   \vspace{10mm}
   \begin{center}
      {\Large\textbf{Abstract}}
   \end{center}
% ? End of heading for abstract.
\end{latexonly}

%  HTML documentation header.
%  ==========================
\begin{htmlonly}
   \xlabel{}
   \begin{rawhtml} <H1> \end{rawhtml}
      \stardoctitle\\
      \stardocversion\\
      \stardocmanual
   \begin{rawhtml} </H1> <HR> \end{rawhtml}

% ? Add picture here if required for the hypertext version.
%   e.g. \includegraphics[scale=0.7]{filename.ps}
% ? End of picture

   \begin{rawhtml} <P> <I> \end{rawhtml}
   \stardoccategory\ \stardocnumber \\
   \stardocauthors \\
   \stardocdate
   \begin{rawhtml} </I> </P> <H3> \end{rawhtml}
      \htmladdnormallink{CCLRC / Rutherford Appleton Laboratory}
                        {http://www.cclrc.ac.uk} \\
      \htmladdnormallink{Particle Physics \& Astronomy Research Council}
                        {http://www.pparc.ac.uk} \\
   \begin{rawhtml} </H3> <H2> \end{rawhtml}
      \htmladdnormallink{Starlink Project}{http://www.starlink.rl.ac.uk/}
   \begin{rawhtml} </H2> \end{rawhtml}
   \htmladdnormallink{\htmladdimg{source.gif} Retrieve hardcopy}
      {http://www.starlink.rl.ac.uk/cgi-bin/hcserver?\stardocsource}\\

%  HTML document table of contents. 
%  ================================
%  Add table of contents header and a navigation button to return to this 
%  point in the document (this should always go before the abstract \section). 
  \label{stardoccontents}
  \begin{rawhtml} 
    <HR>
    <H2>Contents</H2>
  \end{rawhtml}
  \htmladdtonavigation{\htmlref{\htmladdimg{contents_motif.gif}}
        {stardoccontents}}

% ? New section for abstract if used.
  \section{\xlabel{abstract}Abstract}
% ? End of new section for abstract
\end{htmlonly}

% -----------------------------------------------------------------------------
% ? Document Abstract. (if used)
%  ==================
\stardocabstract
% ? End of document abstract

% -----------------------------------------------------------------------------
% ? Latex Copyright Statement
%  =========================
\begin{latexonly}
\newpage
\vspace*{\fill}
\stardoccopyright
\end{latexonly}
% ? End of Latex copyright statement

% -----------------------------------------------------------------------------
% ? Latex document Table of Contents (if used).
%  ===========================================
  \newpage
  \begin{latexonly}
    \setlength{\parskip}{0mm}
    \tableofcontents
    \setlength{\parskip}{\medskipamount}
    \markboth{\stardocname}{\stardocname}
  \end{latexonly}
% ? End of Latex document table of contents
% -----------------------------------------------------------------------------

\cleardoublepage
\renewcommand{\thepage}{\arabic{page}}
\setcounter{page}{1}

%  End of "sst.tex" layout definitions.
% .
% %Z%%M%   %I%   %E% %U%   %D% %T%

% ? Main text
\section{Introduction}
The Odds and Ends  (ONE) library is a collection of
miscellaneous C and Fortran routines called from various packages
in the Starlink Software Collection.
In general these routines have been used in more than one package,
so are suitable to be included in a public library,
but are not suitable for inclusion in one of the other
public libraries of more focussed routines.
\section{List of routines}
These routines were collected by examining possible entries and
by a request for contributions.
Extra routines may be added when necessary.

The contents of the library are (in alphabetical order):\\
\\
\noteroutine{ONE\_EXEC( COMMAND, STATUS )}
    {Executes a shell command.
    Extracted from CCDPACK (submitted by P. Draper).}
\noteroutine{ONE\_FIND\_FILE( FILESPEC, FILENAME, CONTEXT, STATUS )}
    {Returns successive file names that match a file specification.
    Taken from FIGARO and CCDPACK.}
\noteroutine{ONE\_FIND\_FILE\_END( CONTEXT, STATUS )}
    {.Terminate a sequence of FIND\_FILE calls.
    Taken from FIGARO and CCDPACK.}
\noteroutine{ONE\_SCRSZ( WIDTH, HEIGHT, STATUS )}
    {A Fortran callable function to obtain the size of the output screen.
    Taken from CONVERT, KAPPA and IRCAMPACK.}
\section{Routines descriptions}
There follows a full description of the library routines in alphabetical order:
\sstroutine{
   ONE\_EXEC
}{
   Executes a shell command
}{
   \sstdescription{
      This routine gives FORTRAN programs access to the UNIX
      system(3) command. See the system(3) man page for how to
      construct a suitable command.
   }
   \sstinvocation{
      CALL ONE\_EXEC(COMMAND, STATUS)
   }
   \sstarguments{
      \sstsubsection{
         COMMAND = CHARACTER $*$ ( $*$ ) (Given)
      }{
         The command to be executed.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status. Set to SAI\_\_ERROR if command fails.
      }
   }
}
\sstroutine{
   ONE\_FIND\_FILE
}{
   Returns successive file names that match a file specification
}{
   \sstdescription{
      This routine is intended to provide some of the faciltes provided
      on a VAX by the standard VMS routine LIB\$FIND\_FILE.  It is passed
      a file specification that can contain wild card characters such as
      {\tt '}$*${\tt '}, eg {\tt '}$*$.$*${\tt '}. On the first call the Context variable should be set
      to zero, and the routine will return the name of the first file that
      matches the file specification. On subsequent calls the calling
      routine should continue to call using the value of Context returned
      by the previous call, and each call will return the name of the next
      file that matches the specification. When the last file that matches
      the specification has been returned, subsequent calls will return
      a blank string as the file name and an error code (an even value)
      as the function value. Finally, a call to ONE\_FIND\_FILE\_END with the
      last returned value of Context will close down any files opened or
      memory allocated by FIND\_FILE.
   }
   \sstinvocation{
      (from Fortran)
      FOUND = ONE\_FIND\_FILE (FILESPEC,FILENAME,CONTEXT,STATUS)
   }
   \sstarguments{
      \sstsubsection{
         FILESPEC = CHARACTER (Given)
      }{
         The file specification to be matched.  May contain wildcards.
         Case sensitive.
      }
      \sstsubsection{
         FILENAME = CHARACTER (Returned)
      }{
         The name of a file that matches FILESPEC.
      }
      \sstsubsection{
         CONTEXT = INTEGER (Given and Returned)
      }{
         A variable used to remember the context of
         a series of calls for the same file specification.
         Should be set to zero by the caller for the first call
         for a new specification and the value then returned
         by this routine should be used in subsequent calls.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         A status code as follows
         \sstitemlist{

            \sstitem
            SAI\_\_OK for success

            \sstitem
            ONE\_\_NOFILES - No more files found

            \sstitem
            ONE\_\_LENGTHERR - Bad parameter length

            \sstitem
            ONE\_\_PIPEERR  - Pipe error

            \sstitem
            ONE\_\_MALLOCERR - Malloc error
         }
      }
   }
   \sstdiytopic{
      Returned Value:                                                             $*$
   }{
      ONE\_FIND\_FILE = LOGICAL
         TRUE if File Found
         FALSE if error or no more files
   }
   \sstbugs{
      This routine does not provide all the facilities offered by the
      original VAX version; it only accepts the first three arguments as
      listed above, and almost of necessity it uses and expects UNIX syntax
      for the file specs.  This means that {\tt '}/usr/users/ks/$*$.$*${\tt '} is OK, but
      {\tt '}[ks]$*$.$*${\tt '} is not. Note that {\tt '}$*${\tt '} and {\tt '}$*$.$*${\tt '} will give quite different
      results under UNIX, whereas under VMS they would be the same. There
      is no way of specifying recursion; {\tt '}/usr/user/ks/...{\tt '} for example
      is meaningless. Nevertheless, it is hoped that it is close enough in
      functionality to the VMS original to act as a useable substitute in
      most cases. It cannot handle specifications that the standard shell
      (sh) cannot handle in an {\tt '}ls{\tt '} command - there are some variations of
      the {\tt '}ls{\tt '} command involving complex wildcarding that will cause sh
      on a SUN to hang, and they will also hang this routine.

      It is not at all clear that the method used here is  in any way
      the best solution to the problem, and there are a number of possible
      alternatives that could be tried, including using {\tt '}find{\tt '} rather than
      {\tt '}ls{\tt '}, or using routines such as readdir() to search the file system
      and do any pattern matching in this routine itself. The program as it
      stands should be regarded (tolerantly!) as an initial attempt and
      the author would be glad to be sent a better version.
   }
}
\sstroutine{
   ONE\_FIND\_FILE\_END
}{
   Terminate a sequence of FIND\_FILE calls
}{
   \sstdescription{
      This routine should be called after a sequence of calls to FIND\_FILE
      in order to release any resources used by FIND\_FILE.  It should be
      passed in its Context argument the value of the Context argument
      as returned by the FIND\_FILE in the last call in the sequence that
      is to be closed down.
   }
   \sstinvocation{
      (from Fortran)
      CALL ONE\_FIND\_FILE\_END (CONTEXT, STATUS)
   }
   \sstdiytopic{
      Arguements
   }{
      CONTEXT = INTEGER (Given)
         The context argument returned by the last
         call to ONE\_FIND\_FILE in the sequence to be closed down.
      STATUS = INTEGER (Given and Returned)
         A Status Code (Always SAI\_\_OK)
   }
   \sstdiytopic{
      Authors: K. Shortridge, AAO.
   }{
      PDRAPER: P.W. Draper (STARLINK - Durham University)
      DLT: Dave Terrett (STARLINK)
      RTP: Roy Platon (STARLINK)
   }
}
\sstroutine{
   ONE\_SCRSZ
}{
   A Fortran callable function to obtain the size of the output screen
}{
   \sstdescription{
      This routine interrogates the system to find the width and height of the screen
      on which it is running.  Should an error occur or the width is
      not positive, set to the default of 80 characters by 0 lines.
   }
   \sstinvocation{
      CALL ONE\_SCRSZ( WIDTH, HEIGHT, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         WIDTH = INTEGER (Returned)
      }{
         The width of the screen in characters. (default 80)
      }
      \sstsubsection{
         HEIGHT = INTEGER (Returned)
      }{
         The height of the screen in lines. (default 0)
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
         Set to SAI\_\_ERROR if an error occurs..
      }
   }
   \sstnotes{
      This is the UNIX version.
   }
}

% ? End of main text
\end{document}
