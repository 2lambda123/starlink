\sstroutine{
   ATL\_AXTRM
}{
   Trim axes from the current Frame of a FrameSet
}{
   \sstdescription{
      This routine ensures that the number of axes in the current
      Frame of the supplied FrameSet is the same as the number in
      the base Frame. If this is not the case on entry, one or more
      new Frames with the required number of axes are created and
      added into the FrameSet, one of which becomes the new current
      Frame. The only case in which more than one new Frame is added
      is if the current Frame has too many axes, and the FrameSet
      contains more than one {\tt "}ROI{\tt "} Frame (that is, Frames which are
      Regions and which have a Domain name beginning with {\tt "}ROI{\tt "}). If
      the FrameSet contains zero or one ROI Frame, then only a single
      new Frame is added into the FrameSet.

      If the original current Frame has too few axes, the new Frame
      is a copy of the original current Frame with extra simple axes
      added to the end. These extra axes are supplied a value of
      AST\_\_BAD by the Mapping which connects the original current
      Frame to the new current Frame.

      If the original current Frame has too many axes, one or more
      new Frames will be created by picking the specified axes from
      the original current Frame. Each of these Frames is added into
      the FrameSet using a Mapping which has a forward transformation
      which simply drops the values for the unselected axes. The
      inverse transformation (from new to old Frame) attempts to
      assign usable values for the dropped axes if possible. If this
      is not possible, then AST\_\_BAD is assigned to the dropped axes.

      Two methods are used for finding suitable values to assign to
      dropped axes. The first is only possible if the value for a
      dropped axis can be determined uniquely from the value of one
      of the retained axes. This may be the case for instance in a
      situation where (RA,wavelength) axes were selected from the
      (RA,Dec,Wavelength) axes describing a 2D longslit spectrum. The
      missing Dec value can probably be determined from the RA value
      because the relationship between RA and Dec is determined by the
      position and orientation of the slit on the sky.

      If it is not possible to determine the value for a dropped axis
      in this way, then a search is made for Frames that are Regions
      having a Domain name beginning with {\tt "}ROI{\tt "}. If any are found,
      then a new Frame is added into the FrameSet for each ROI Region
      found, connected to the original current Frame via a PermMap.
      The values to be assigned to the dropped axes by the inverse
      PermMap transformation are determined by transforming the
      bounding box of the corresponding ROI Region into the original
      current Frame. The assigned axis values are the mean values of
      the transformed bounding box on each dropped axis. The Domain
      name of the corresponding ROI Region is stored in the Ident
      attribute of each new Frame so that later code can identify the
      corresponding ROI Region, and is also appended to the end of the
      Frame{\tt '}s Domain. The new Frame corresponding to the first ROI
      Region found in the FrameSet is left as the current Frame on exit.
   }
   \sstinvocation{
      CALL ATL\_AXTRM( IWCS, AXES, LBND, UBND, WORK, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         IWCS = INTEGER (Given)
      }{
         The FrameSet to use. A new current Frame may be added to the
         FrameSet by this routine.
      }
      \sstsubsection{
         AXES( $*$ ) = INTEGER (Given)
      }{
         The one-based indices of the axes to be retained in the event
         of there being too many axes in the original current Frame
         of IWCS. The number of values in the array should be equal to
         the number of axes in the base Frame of IWCS (i.e the number
         of pixel axes).
      }
      \sstsubsection{
         LBND( $*$ ) = INTEGER (Given)
      }{
         The lower pixel index bounds of the NDF from which the
         FrameSet was obtained. The number of values in the array
         should be equal to the number of axes in the base Frame of
         IWCS (i.e the number of pixel axes).
      }
      \sstsubsection{
         UBND( $*$ ) = INTEGER (Given)
      }{
         The upper pixel index bounds of the NDF from which the
         FrameSet was obtained. The number of values in the array
         should be equal to the number of axes in the base Frame of
         IWCS (i.e the number of pixel axes).
      }
      \sstsubsection{
         WORK( $*$ ) = INTEGER (Given)
      }{
         Work space. It{\tt '}s length should be at least twice as large as
         the largest pixel dimension implied by LBND and UBND.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
      }
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 2006 Particle Physics \& Astronomy Research Council.
      All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful,but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
\sstroutine{
   ATL\_CREAT
}{
   Write an AST Object to a text file or NDF specified using an environment
   parameter
}{
   \sstdescription{
      Write an AST Object to a text file or NDF specified using an environment
      parameter.
   }
   \sstinvocation{
      CALL ATL\_CREAT( PARAM, IAST, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         PARAM = CHARACTER $*$ ( $*$ ) (Given)
      }{
         The parameter name.
      }
      \sstsubsection{
         IAST = INTEGER (Given)
      }{
         The AST Object, or AST\_\_NULL.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
      }
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 2001, 2003 Central Laboratory of the Research
      Councils. All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful, but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
\sstroutine{
   ATL\_FSPEC
}{
   Locate a SpecFrame within a CmpFrame
}{
   \sstdescription{
      This routine searches the supplied CmpFrame for an axis that is a
      SpecFrame. It returns the axis index of the SpecFrame within the
      CmpFrame, and also returns a pointer to the SpecFrame itself.

      No error is reported if the CmpFrame does not contain a SpecFrame.
      If the CmpFrame contains more than one SpecFrame, the first (i.e.
      the lowest index) is returned.
   }
   \sstinvocation{
      CALL ATL\_FSPEC( FRM, SPAX, SPFRM, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         FRM= INTEGER (Given)
      }{
         The CmpFrame pointer.
      }
      \sstsubsection{
         SPAX = INTEGER (Returned)
      }{
         The index of the spectral axis within the CmpFrame. Returned
         equal to zero if no spectral axis is found.
      }
      \sstsubsection{
         SPFRM = INTEGER (Returned)
      }{
         A pointer to the SpecFrame. Returned equal to AST\_\_NULL if no
         spectral axis is found.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
      }
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 2006 Particle Physics \& Astronomy Research Council.
      All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful,but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
\sstroutine{
   ATL\_GTGRP
}{
   Obtain lines of text from a parameter, and store them in a GRP group
}{
   \sstdescription{
      Currently this routine expects the parameter to be associated with:

      1 - a text file (the returned group contains the lines of the file).
      2 - a FITS file (the returned group contains the FITS headers).

      In future it may be possible to add other ways of using the
      parameter (i.e. by associating it with objects other than text
      files).
   }
   \sstinvocation{
      CALL ATL\_GTGRP( PARAM, IGRP, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         PARAM = CHARACTER $*$ ( $*$ ) (Given)
      }{
         The parameter name.
      }
      \sstsubsection{
         IGRP = INTEGER (Returned)
      }{
         The AST Object, or AST\_\_NULL.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
      }
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 2001 Central Laboratory of the Research Councils.
      All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful, but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
\sstroutine{
   ATL\_MKLUT
}{
   Create a Mapping to connect two 1D array of values
}{
   \sstdescription{
      This routine creates a 1D Mapping which translates an X into a Y
      value on the basis of supplied tables of corresponding X and Y.
      This is like an AST LutMap except that the LutMap class requires Y
      to be tabulated at equal X intervals, whereas this routine allows
      Y to be tabulated at arbitrary X intervals.
   }
   \sstinvocation{
      CALL ATL\_MKLUT( IX, IY, NPNT, NVAR, FRM, TABLE, MAP, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         IX = INTEGER (Given)
      }{
         The index of the X values within the TABLE array.
      }
      \sstsubsection{
         IY = INTEGER (Given)
      }{
         The index of the Y values within the TABLE array.
      }
      \sstsubsection{
         NPNT = INTEGER (Given)
      }{
         The number of values supplied for each variable in the TABLE
         array.
      }
      \sstsubsection{
         NVAR = INTEGER (Given)
      }{
         The number of variables described in the table. This will be at
         least 2 (for X and Y) but may be more.
      }
      \sstsubsection{
         FRM = INTEGER (Given)
      }{
         If not AST\_\_NULL, then this should be an AST pointer to a Frame
         with NVAR axes which will be used to normalise the axis values
         before creating the LutMap. No normalisation occurs if a value of
         AST\_\_NULL is supplied.
      }
      \sstsubsection{
         TABLE( NPNT, NVAR ) = DOUBLE PRECISION (Given and Returned)
      }{
         The table containing corresponding X and Y values. The table can
         also contain values for other variables, which will be ignored.
         These will be normalised on exit using the AST Frame supplied by
         FRM.
      }
      \sstsubsection{
         MAP = INTEGER (Returned)
      }{
         An AST pointer to the returned Mapping, or AST\_\_NULL if no Mapping
         could be created.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
      }
   }
   \sstnotes{
      \sstitemlist{

         \sstitem
         It is only possible to create the Mapping if the tabluated X values
         are monotonic increasing or decreasing.

         \sstitem
         The returned Mapping will have an inverse Transformation only if Y
         increases or decreases monotonically with X.
      }
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 2005 Particle Physics \& Astronomy Research Council.
      All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful,but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
\sstroutine{
   ATL\_NOTIF
}{
   Print a message to the screen if ATOOLS\_VERBOSE is set
}{
   \sstdescription{
      Print a message to the screen if ATOOLS\_VERBOSE is set.
   }
   \sstinvocation{
      CALL ATL\_NOTIF( MSG, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         MSG = CHARACTER $*$ ( $*$ ) (Given)
      }{
         The message.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
      }
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 2003 Central Laboratory of the Research Councils.
      All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful, but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
\sstroutine{
   ATL\_RDCH
}{
   Read an AST Object from a GRP group using a Channel
}{
   \sstdescription{
      Read an AST Object from a GRP group using a Channel.
   }
   \sstinvocation{
      CALL ATL\_RDCH( IGRP, IAST, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         IGRP = INTEGER (Given)
      }{
         An identifier for the group holding the text.
      }
      \sstsubsection{
         IAST = INTEGER (Returned)
      }{
         The AST Object, or AST\_\_NULL.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
      }
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 2001 Central Laboratory of the Research Councils.
      All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful, but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
\sstroutine{
   ATL\_RDFCH
}{
   Read an AST Object from a GRP group using a FitsChan
}{
   \sstdescription{
      Read an AST Object from a GRP group using a FitsChan.
   }
   \sstinvocation{
      CALL ATL\_RDFCH( IGRP, IAST, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         IGRP = INTEGER (Given)
      }{
         An identifier for the group holding the text.
      }
      \sstsubsection{
         IAST = INTEGER (Returned)
      }{
         The AST Object, or AST\_\_NULL.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
      }
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 2001, 2003 Central Laboratory of the Research
      Councils. All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful, but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
\sstroutine{
   ATL\_RDGRP
}{
   Read an AST Object from a GRP group
}{
   \sstdescription{
      Read an AST Object from a GRP group.
   }
   \sstinvocation{
      CALL ATL\_RDGRP( IGRP, IAST, STATUS )
   }
   \sstarguments{
      \sstsubsection{
         IGRP = INTEGER (Given)
      }{
         An identifier for the group holding the text.
      }
      \sstsubsection{
         IAST = INTEGER (Returned)
      }{
         The AST Object, or AST\_\_NULL.
      }
      \sstsubsection{
         STATUS = INTEGER (Given and Returned)
      }{
         The global status.
      }
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 2001 Central Laboratory of the Research Councils.
      All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful, but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
\sstroutine{
   ATL\_RM
}{
   Remove a file
}{
   \sstdescription{
      This subroutine calls the {\tt "}PSX\_REMOVE{\tt "} RTL function to remove a
      specified file. No error occurs if the file cannot be removed for
      any reason.
   }
   \sstinvocation{
      CALL ATL\_RM( FILE, STATUS )
   }
   \sstdiytopic{
      Parameters
   }{
      FILE = CHARACTER $*$ ( $*$ ) (Given)
         The path to the file.
      STATUS = INTEGER (Given and Returned)
         The inherited global status.
   }
   \sstdiytopic{
      Copyright
   }{
      Copyright (C) 1999 Central Laboratory of the Research Councils.
      Copyright (C) 2005 Particle Physics \& Astronomy Research Council.
      All Rights Reserved.
   }
   \sstdiytopic{
      Licence
   }{
      This program is free software; you can redistribute it and/or
      modify it under the terms of the GNU General Public License as
      published by the Free Software Foundation; either version 2 of
      the License, or (at your option) any later version.

      This program is distributed in the hope that it will be
      useful, but WITHOUT ANY WARRANTY; without even the implied
      warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
      PURPOSE. See the GNU General Public License for more details.

      You should have received a copy of the GNU General Public License
      along with this program; if not, write to the Free Software
      Foundation, Inc., 59 Temple Place,Suite 330, Boston, MA
      02111-1307, USA
   }
}
