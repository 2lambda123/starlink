      SUBROUTINE snx_AGCS
*+
*  Name:
*     AGCS

*  Purpose:
*     Set the world coordinate extent of the current SGS
*     zone to match the grid coordinate extent of the NCAR
*     AUTOGRAPH graph window.

*  Language:
*     Starlink Fortran 77

*  Description:
*     The result will only be useful if the current SGS zone
*     and the AUTOGRAPH graph window occupy the same region
*     of the display surface.  This will be the case if the
*     snx_AGWV routine has been called following the creation
*     of the current zone.  Assuming this requirement is met,
*     calling this routine will adjust the world coordinate
*     bounds of the current zone such that the region
*     (0.0,1.0,0.0,1.0) coincides with the AUTOGRAPH grid
*     window.

*  Externals:
*     sgs_SW

*  Authors:
*     PTW: P. T. Wallace (Starlink)
*     BKM: Brian McIlwrath (Starlink)
*     {enter_new_authors_here}

*  History:
*     01-APR-1986 (PTW):
*        Original.
*     28-05-1996 (BKM):
*        Initialise local status value J before calling SGS routines.
*     {enter_further_changes_here}

*  Bugs:
*     {note_any_bugs_here}

*  From Common:
*     XRGD,XLGD,YTGD,YBGD from /AGCONP/

*-

      IMPLICIT NONE

*  AUTOGRAPH control parameters
      REAL QFRA,QSET,QROW,QIXY,QWND,QBAC,SVAL(2),
     :     XLGF,XRGF,YBGF,YTGF,XLGD,XRGD,YBGD,YTGD,SOGD,
     :     XMIN,XMAX,QLUX,QOVX,QCEX,XLOW,XHGH,
     :     YMIN,YMAX,QLUY,QOVY,QCEY,YLOW,YHGH,
     :     QDAX(4),QSPA(4),PING(4),PINU(4),FUNS(4),QBTD(4),
     :     BASD(4),QMJD(4),QJDP(4),WMJL(4),WMJR(4),QMND(4),
     :     QNDP(4),WMNL(4),WMNR(4),QLTD(4),QLED(4),QLFD(4),
     :     QLOF(4),QLOS(4),DNLA(4),WCLM(4),WCLE(4),
     :     QODP,QCDP,WOCD,WODQ,QDSH(26),
     :     QDLB,QBIM,FLLB(10,8),QBAN,
     :     QLLN,TCLN,QNIM,FLLN(6,16),QNAN,
     :     XLGW,XRGW,YBGW,YTGW,XLUW,XRUW,YBUW,YTUW,
     :     XLCW,XRCW,YBCW,YTCW,WCWP,HCWP,SCWP,
     :     XBGA(4),YBGA(4),UBGA(4),XNDA(4),YNDA(4),UNDA(4),
     :     QBTP(4),BASE(4),QMNT(4),QLTP(4),QLEX(4),QLFL(4),
     :     QCIM(4),QCIE(4),RFNL(4),WNLL(4),WNLR(4),WNLB(4),
     :     WNLE(4),QLUA(4),
     :     RBOX(6),DBOX(6,4),SBOX(6,4)
      COMMON /AGCONP/ QFRA,QSET,QROW,QIXY,QWND,QBAC,SVAL,
     :                XLGF,XRGF,YBGF,YTGF,XLGD,XRGD,YBGD,YTGD,SOGD,
     :                XMIN,XMAX,QLUX,QOVX,QCEX,XLOW,XHGH,
     :                YMIN,YMAX,QLUY,QOVY,QCEY,YLOW,YHGH,
     :                QDAX,QSPA,PING,PINU,FUNS,QBTD,
     :                BASD,QMJD,QJDP,WMJL,WMJR,QMND,
     :                QNDP,WMNL,WMNR,QLTD,QLED,QLFD,
     :                QLOF,QLOS,DNLA,WCLM,WCLE,
     :                QODP,QCDP,WOCD,WODQ,QDSH,
     :                     QDLB,QBIM,FLLB,QBAN,
     :                QLLN,TCLN,QNIM,FLLN,QNAN,
     :                XLGW,XRGW,YBGW,YTGW,XLUW,XRUW,YBUW,YTUW,
     :                XLCW,XRCW,YBCW,YTCW,WCWP,HCWP,SCWP,
     :                XBGA,YBGA,UBGA,XNDA,YNDA,UNDA,
     :                QBTP,BASE,QMNT,QLTP,QLEX,QLFL,
     :                QCIM,QCIE,RFNL,WNLL,WNLR,WNLB,
     :                WNLE,QLUA,
     :                RBOX,DBOX,SBOX

      REAL SMALL
      PARAMETER (SMALL=1E-4)
      REAL FX,FY
      INTEGER IZ,J



*  Unused fraction of graph window (keep sensible)
      FX=MAX(XRGD-XLGD,SMALL)
      FY=MAX(YTGD-YBGD,SMALL)

*  Reselect current zone
      CALL sgs_ICURZ(IZ)
      J=0
      CALL sgs_SELZ(IZ,J)

*  Set world coordinates of current zone
      CALL sgs_SW(-XLGD/FX,(FX+1.0-XRGD)/FX,
     :            -YBGD/FY,(FY+1.0-YTGD)/FY,J)

      END
