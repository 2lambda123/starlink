      SUBROUTINE THSTGR (IERROR)
C
C WRITTEN                MAY 1985
C
C PURPOSE                TO PROVIDE A SIMPLE DEMONSTRATION OF
C                        HSTGRM AND TO TEST HSTGRM ON A
C                        SIMPLE PROBLEM
C
C USAGE                  CALL THSTGR (IERROR)
C
C ARGUMENTS
C
C ON OUTPUT              IERROR
C                          AN ERROR PARAMETER
C                          = 0, IF THE TEST IS SUCCESSFUL,
C                          = 1, OTHERWISE
C
C I/O                    IF THE TEST IS SUCCESSFUL, THE MESSAGE
C
C                          HSTGRM TEST SUCCESSFUL  . . .  SEE PLOT
C                          TO VERIFY PERFORMANCE
C
C                        IS WRITTEN ON UNIT 6.
C
C                        IN ADDITION, THREE (3) LABELLED FRAMES
C                        CONTAINING THE PLOTS ARE
C                        PRODUCED ON THE MACHINE GRAPHICS DEVICE.
C                        TO DETERMINE IF THE TEST WAS SUCCESSFUL,
C                        IT IS NECESSARY TO EXAMINE THESE PLOTS.
C
C PRECISION              SINGLE
C
C REQUIRED LIBRARY       HSTGRM
C FILES
C
C LANGUAGE               FORTRAN77
C
C HISTORY                ORIGINALLY WRITTEN IN MAY, 1985
C
C ALGORITHM              THSTGR COMPUTES DATA AND THEN CALLS HSTGRM
C                        5 TIMES, EXERCISING DIFFERENT OPTIONS.
C
C
C PORTABILITY            FORTRAN 77
C
C  ARRAY ARR IS FILLED WITH VALUES TO BE USED AS INPUT FOR HSTGRM
C
      REAL  INARR(100), X, ARR7(7), WORK(212)
      INTEGER  IWORK(84)
C
      DATA TX /.5/, TY/.9765/
C
C  CALL ENTSR (FROM PORT LIBRARY) TO RECOVER FROM WARNINGS
C
      CALL ENTSR(IDUM, 1)
C
      DO  10 I=1,100
        X = FLOAT(I)
        INARR(I) = 10. * ALOG10(X)
  10  CONTINUE
C
C  DEMONSTRATE THE DEFAULT VERSION OF HSTGRM
C
      NPTS = 100
      NCLASS = 11
      RLO = 2.
      RHI = 19.7
      LWORK = 8 * (NCLASS + 3) + NPTS
      LIWORK = 6 * (NCLASS + 3)
C
      CALL WTSTR (TX,TY,
     + 'DEMONSTRATION PLOT FOR DEFAULT VERSION OF HSTGRM',2,0,0)
      CALL HSTGRM(INARR, NPTS, RLO, RHI, NCLASS, WORK, LWORK,
     + IWORK, LIWORK)
C
C  DEMONSTRATE HSTGRM WITH HORIZONTAL, TITLE AND MEDIAN OPTIONS ON
C
      CALL HSTOPC('TI=ON',
     +'OPTIONS CHANGED: HOR, MED, AND TIT')
      CALL HSTOPL('HO=ON')
      CALL HSTOPL('ME=ON')
      CALL HSTGRM(INARR, NPTS, RLO, RHI, NCLASS, WORK, LWORK,
     + IWORK, LIWORK)
C
C  DEMONSTRATE HSTGRM WITH PERIMETER AND WINDOWING OPTIONS ON
C  AND FRAME OPTION OFF
C  (FIRST CALL HSTOPL('DEF=ON') TO RESET OPTIONS TO DEFAULT)
C
      CALL HSTOPL('DE=ON')
      CALL HSTOPC('TI=ON',
     +'OPTIONS CHANGED: PRM,FRA,TIT,WIN AND MID')
      CALL HSTOPL('PRM=ON')
      CALL HSTOPL('MID=ON')
      CALL HSTOPL('FRA=OF')
      ARR7(1) = 0.
      ARR7(2) = .5
      ARR7(3) = .5
      ARR7(4) = 1.
      CALL HSTOPR('WIN=ON',ARR7,4)
C
      CALL HSTGRM(INARR, NPTS, RLO, RHI, NCLASS, WORK, LWORK,
     + IWORK, LIWORK)
C
C
      X = 0.
      DO 20 I = 1,100
        INARR(I) = SIN(X)
        X = X + .07
  20  CONTINUE
      RLO = -.6015
      RHI = .6015
      NCLASS = 11
C
C  DEMONSTRATE HSTGRM WITH WINDOWING OPTION ON AND SHADING AND
C  FRAME OPTIONS OFF
C  (FIRST CALL HSTOPL('DEF=ON') TO RESET ALL OPTIONS TO DEFAULT)
C
      CALL HSTOPL('DE=ON')
      CALL HSTOPC('TI=ON',
     +'OPTIONS CHANGED: WIN,SHA,TIT AND FRA')
      CALL HSTOPL('FRA=OF')
      ARR7(1) = .5
      ARR7(2) = 1.
      ARR7(3) = .5
      ARR7(4) = 1.
      CALL HSTOPR('WIN=ON',ARR7,4)
      CALL HSTOPL('SHA=OFF')
      NCLASS = 8
      CALL HSTGRM(INARR, NPTS, RLO, RHI, NCLASS, WORK, LWORK,
     + IWORK, LIWORK)
C
C  DEMONSTRATE HSTGRM WITH WINDOWING OPTION ON AND SHADING AND
C  FRAME OPTIONS OFF
C  (CALL HSTOPL('DEF=ON') TO RESET ALL OPTIONS TO DEFAULT)
C
      CALL HSTOPL('DE=ON')
      CALL HSTOPC('TI=ON',
     +'OPTIONS CHANGED: LAB,FQN,TIT,PER,FOR AND WIN')
      ARR7(1) = .2
      ARR7(2) = .8
      ARR7(3) = 0.
      ARR7(4) = .5
      CALL HSTOPR('WIN=ON',ARR7,4)
      CALL HSTOPL('PER=OFF')
      CALL HSTOPC('LAB=ON','A DIFFERENT USER LABEL')
      CALL HSTOPC('FQN=ON','NUMBER OF OCCURENCES IN EACH CLASS')
      CALL HSTOPC('FOR=ON','(F10.5)')
      NCLASS = 11
      CALL HSTGRM(INARR, NPTS, RLO, RHI, NCLASS, WORK, LWORK,
     + IWORK, LIWORK)
C
C
      IERROR = 0
      WRITE (6,1001)
C
      RETURN
C
 1001 FORMAT ('  HSTGRM TEST SUCCESSFUL',24X,
     1        'SEE PLOT TO VERIFY PERFORMANCE')
C
      END
