      SUBROUTINE HSTGRM(DATA,NPTS,RLOW,RHI,NCLASS,WORK,LWORK,
     -IWORK,LIWORK)
      EXTERNAL HSTBKD
      COMMON /HSTGC1/ HORZNT, PERCNT, MIDVAL, SHADE, MEDIAN, PERIM,
     -       HFRAME, LISTOP, WINDOW, COLORS, HSTFOR, TITLE, LABEL,
     -       FREQNC, HWIND(4), COLSHA, COLREC, COLAXI, COLMED, COLTEX,
     -       COLTIT, COLPER
      LOGICAL HORZNT, PERCNT, MIDVAL, SHADE, MEDIAN, PERIM, HFRAME,
     -        LISTOP, WINDOW, COLORS, HSTFOR, TITLE, LABEL, FREQNC
      COMMON /HSTGC2/ STRFOR, STRTIT, STRLAB, STRFRE
      CHARACTER*55  STRFOR, STRTIT, STRLAB, STRFRE
C
      INTEGER  NPTS, NCLASS
      DIMENSION DATA(NPTS), WORK(LWORK), IWORK(LIWORK)
      REAL     RLOW, RHI
      SAVE
C
      NXY = 2 * (3 + NCLASS)
      NY = NXY + 1
      NY2 = 2 * NXY + 1
      NY3 = NY2 + NPTS
C
C  CHECK LENGTH OF ARRAY WORK
C
      IER = 0
      IF (SHADE) THEN
          ISIZE = 4*NXY + NPTS
          JSIZE = 3*NXY
      ELSE
          ISIZE = 2*NXY + NPTS
          JSIZE = 0
      ENDIF
      IF (LWORK .LT. ISIZE) THEN
          IER = 1
      ENDIF
      IF (LIWORK .LT. JSIZE) THEN
          IF (IER .NE. 0) THEN
              IER = 3
          ELSE
              IER = 2
          ENDIF
      ENDIF
      CALL HST1(DATA,NPTS,RLOW,RHI,NCLASS,NXY,2*NXY,WORK(1),WORK(NY),
     -WORK(NY2),WORK(NY3),IWORK,LIWORK,IER)
      RETURN
      END
